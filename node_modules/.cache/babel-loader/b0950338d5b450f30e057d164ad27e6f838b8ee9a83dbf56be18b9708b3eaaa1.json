{"ast":null,"code":"import { BubbleMenuPlugin } from '@tiptap/extension-bubble-menu';\nimport React, { forwardRef, useRef, useState, useEffect, createContext, useContext } from 'react';\nimport ReactDOM, { flushSync } from 'react-dom';\nimport { Editor as Editor$1, NodeView } from '@tiptap/core';\nexport * from '@tiptap/core';\nimport { FloatingMenuPlugin } from '@tiptap/extension-floating-menu';\nconst mergeRefs = (...refs) => {\n  return node => {\n    refs.forEach(ref => {\n      if (typeof ref === 'function') {\n        ref(node);\n      } else if (ref) {\n        ref.current = node;\n      }\n    });\n  };\n};\nconst Portals = ({\n  renderers\n}) => {\n  return React.createElement(React.Fragment, null, Object.entries(renderers).map(([key, renderer]) => {\n    return ReactDOM.createPortal(renderer.reactElement, renderer.element, key);\n  }));\n};\nclass PureEditorContent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.editorContentRef = React.createRef();\n    this.initialized = false;\n    this.state = {\n      renderers: {}\n    };\n  }\n  componentDidMount() {\n    this.init();\n  }\n  componentDidUpdate() {\n    this.init();\n  }\n  init() {\n    const {\n      editor\n    } = this.props;\n    if (editor && editor.options.element) {\n      if (editor.contentComponent) {\n        return;\n      }\n      const element = this.editorContentRef.current;\n      element.append(...editor.options.element.childNodes);\n      editor.setOptions({\n        element\n      });\n      editor.contentComponent = this;\n      editor.createNodeViews();\n      this.initialized = true;\n    }\n  }\n  maybeFlushSync(fn) {\n    // Avoid calling flushSync until the editor is initialized.\n    // Initialization happens during the componentDidMount or componentDidUpdate\n    // lifecycle methods, and React doesn't allow calling flushSync from inside\n    // a lifecycle method.\n    if (this.initialized) {\n      flushSync(fn);\n    } else {\n      fn();\n    }\n  }\n  setRenderer(id, renderer) {\n    this.maybeFlushSync(() => {\n      this.setState(({\n        renderers\n      }) => ({\n        renderers: {\n          ...renderers,\n          [id]: renderer\n        }\n      }));\n    });\n  }\n  removeRenderer(id) {\n    this.maybeFlushSync(() => {\n      this.setState(({\n        renderers\n      }) => {\n        const nextRenderers = {\n          ...renderers\n        };\n        delete nextRenderers[id];\n        return {\n          renderers: nextRenderers\n        };\n      });\n    });\n  }\n  componentWillUnmount() {\n    const {\n      editor\n    } = this.props;\n    if (!editor) {\n      return;\n    }\n    this.initialized = false;\n    if (!editor.isDestroyed) {\n      editor.view.setProps({\n        nodeViews: {}\n      });\n    }\n    editor.contentComponent = null;\n    if (!editor.options.element.firstChild) {\n      return;\n    }\n    const newElement = document.createElement('div');\n    newElement.append(...editor.options.element.childNodes);\n    editor.setOptions({\n      element: newElement\n    });\n  }\n  render() {\n    const {\n      editor,\n      innerRef,\n      ...rest\n    } = this.props;\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      ref: mergeRefs(innerRef, this.editorContentRef),\n      ...rest\n    }), React.createElement(Portals, {\n      renderers: this.state.renderers\n    }));\n  }\n}\n// EditorContent should be re-created whenever the Editor instance changes\nconst EditorContentWithKey = forwardRef((props, ref) => {\n  const key = React.useMemo(() => {\n    return Math.floor(Math.random() * 0xFFFFFFFF).toString();\n  }, [props.editor]);\n  // Can't use JSX here because it conflicts with the type definition of Vue's JSX, so use createElement\n  return React.createElement(PureEditorContent, {\n    key,\n    innerRef: ref,\n    ...props\n  });\n});\nconst EditorContent = React.memo(EditorContentWithKey);\nclass Editor extends Editor$1 {\n  constructor() {\n    super(...arguments);\n    this.contentComponent = null;\n  }\n}\nconst useEditor = (options = {}, deps = []) => {\n  const editorRef = useRef(null);\n  const [, forceUpdate] = useState({});\n  const {\n    onBeforeCreate,\n    onBlur,\n    onCreate,\n    onDestroy,\n    onFocus,\n    onSelectionUpdate,\n    onTransaction,\n    onUpdate\n  } = options;\n  const onBeforeCreateRef = useRef(onBeforeCreate);\n  const onBlurRef = useRef(onBlur);\n  const onCreateRef = useRef(onCreate);\n  const onDestroyRef = useRef(onDestroy);\n  const onFocusRef = useRef(onFocus);\n  const onSelectionUpdateRef = useRef(onSelectionUpdate);\n  const onTransactionRef = useRef(onTransaction);\n  const onUpdateRef = useRef(onUpdate);\n  // This effect will handle updating the editor instance\n  // when the event handlers change.\n  useEffect(() => {\n    if (!editorRef.current) {\n      return;\n    }\n    if (onBeforeCreate) {\n      editorRef.current.off('beforeCreate', onBeforeCreateRef.current);\n      editorRef.current.on('beforeCreate', onBeforeCreate);\n      onBeforeCreateRef.current = onBeforeCreate;\n    }\n    if (onBlur) {\n      editorRef.current.off('blur', onBlurRef.current);\n      editorRef.current.on('blur', onBlur);\n      onBlurRef.current = onBlur;\n    }\n    if (onCreate) {\n      editorRef.current.off('create', onCreateRef.current);\n      editorRef.current.on('create', onCreate);\n      onCreateRef.current = onCreate;\n    }\n    if (onDestroy) {\n      editorRef.current.off('destroy', onDestroyRef.current);\n      editorRef.current.on('destroy', onDestroy);\n      onDestroyRef.current = onDestroy;\n    }\n    if (onFocus) {\n      editorRef.current.off('focus', onFocusRef.current);\n      editorRef.current.on('focus', onFocus);\n      onFocusRef.current = onFocus;\n    }\n    if (onSelectionUpdate) {\n      editorRef.current.off('selectionUpdate', onSelectionUpdateRef.current);\n      editorRef.current.on('selectionUpdate', onSelectionUpdate);\n      onSelectionUpdateRef.current = onSelectionUpdate;\n    }\n    if (onTransaction) {\n      editorRef.current.off('transaction', onTransactionRef.current);\n      editorRef.current.on('transaction', onTransaction);\n      onTransactionRef.current = onTransaction;\n    }\n    if (onUpdate) {\n      editorRef.current.off('update', onUpdateRef.current);\n      editorRef.current.on('update', onUpdate);\n      onUpdateRef.current = onUpdate;\n    }\n  }, [onBeforeCreate, onBlur, onCreate, onDestroy, onFocus, onSelectionUpdate, onTransaction, onUpdate, editorRef.current]);\n  useEffect(() => {\n    let isMounted = true;\n    editorRef.current = new Editor(options);\n    editorRef.current.on('transaction', () => {\n      requestAnimationFrame(() => {\n        requestAnimationFrame(() => {\n          if (isMounted) {\n            forceUpdate({});\n          }\n        });\n      });\n    });\n    return () => {\n      isMounted = false;\n    };\n  }, deps);\n  useEffect(() => {\n    return () => {\n      var _a;\n      return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.destroy();\n    };\n  }, []);\n  return editorRef.current;\n};\nconst EditorContext = createContext({\n  editor: null\n});\nconst EditorConsumer = EditorContext.Consumer;\nconst useCurrentEditor = () => useContext(EditorContext);\nconst EditorProvider = ({\n  children,\n  slotAfter,\n  slotBefore,\n  ...editorOptions\n}) => {\n  const editor = useEditor(editorOptions);\n  if (!editor) {\n    return null;\n  }\n  return React.createElement(EditorContext.Provider, {\n    value: {\n      editor\n    }\n  }, slotBefore, React.createElement(EditorConsumer, null, ({\n    editor: currentEditor\n  }) => React.createElement(EditorContent, {\n    editor: currentEditor\n  })), children, slotAfter);\n};\nconst BubbleMenu = props => {\n  const [element, setElement] = useState(null);\n  const {\n    editor: currentEditor\n  } = useCurrentEditor();\n  useEffect(() => {\n    var _a;\n    if (!element) {\n      return;\n    }\n    if (((_a = props.editor) === null || _a === void 0 ? void 0 : _a.isDestroyed) || (currentEditor === null || currentEditor === void 0 ? void 0 : currentEditor.isDestroyed)) {\n      return;\n    }\n    const {\n      pluginKey = 'bubbleMenu',\n      editor,\n      tippyOptions = {},\n      updateDelay,\n      shouldShow = null\n    } = props;\n    const menuEditor = editor || currentEditor;\n    if (!menuEditor) {\n      console.warn('BubbleMenu component is not rendered inside of an editor component or does not have editor prop.');\n      return;\n    }\n    const plugin = BubbleMenuPlugin({\n      updateDelay,\n      editor: menuEditor,\n      element,\n      pluginKey,\n      shouldShow,\n      tippyOptions\n    });\n    menuEditor.registerPlugin(plugin);\n    return () => menuEditor.unregisterPlugin(pluginKey);\n  }, [props.editor, currentEditor, element]);\n  return React.createElement(\"div\", {\n    ref: setElement,\n    className: props.className,\n    style: {\n      visibility: 'hidden'\n    }\n  }, props.children);\n};\nconst FloatingMenu = props => {\n  const [element, setElement] = useState(null);\n  const {\n    editor: currentEditor\n  } = useCurrentEditor();\n  useEffect(() => {\n    var _a;\n    if (!element) {\n      return;\n    }\n    if (((_a = props.editor) === null || _a === void 0 ? void 0 : _a.isDestroyed) || (currentEditor === null || currentEditor === void 0 ? void 0 : currentEditor.isDestroyed)) {\n      return;\n    }\n    const {\n      pluginKey = 'floatingMenu',\n      editor,\n      tippyOptions = {},\n      shouldShow = null\n    } = props;\n    const menuEditor = editor || currentEditor;\n    if (!menuEditor) {\n      console.warn('FloatingMenu component is not rendered inside of an editor component or does not have editor prop.');\n      return;\n    }\n    const plugin = FloatingMenuPlugin({\n      pluginKey,\n      editor: menuEditor,\n      element,\n      tippyOptions,\n      shouldShow\n    });\n    menuEditor.registerPlugin(plugin);\n    return () => menuEditor.unregisterPlugin(pluginKey);\n  }, [props.editor, currentEditor, element]);\n  return React.createElement(\"div\", {\n    ref: setElement,\n    className: props.className,\n    style: {\n      visibility: 'hidden'\n    }\n  }, props.children);\n};\nconst ReactNodeViewContext = createContext({\n  onDragStart: undefined\n});\nconst useReactNodeView = () => useContext(ReactNodeViewContext);\nconst NodeViewContent = props => {\n  const Tag = props.as || 'div';\n  const {\n    nodeViewContentRef\n  } = useReactNodeView();\n  return React.createElement(Tag, {\n    ...props,\n    ref: nodeViewContentRef,\n    \"data-node-view-content\": \"\",\n    style: {\n      whiteSpace: 'pre-wrap',\n      ...props.style\n    }\n  });\n};\nconst NodeViewWrapper = React.forwardRef((props, ref) => {\n  const {\n    onDragStart\n  } = useReactNodeView();\n  const Tag = props.as || 'div';\n  return React.createElement(Tag, {\n    ...props,\n    ref: ref,\n    \"data-node-view-wrapper\": \"\",\n    onDragStart: onDragStart,\n    style: {\n      whiteSpace: 'normal',\n      ...props.style\n    }\n  });\n});\nfunction isClassComponent(Component) {\n  return !!(typeof Component === 'function' && Component.prototype && Component.prototype.isReactComponent);\n}\nfunction isForwardRefComponent(Component) {\n  var _a;\n  return !!(typeof Component === 'object' && ((_a = Component.$$typeof) === null || _a === void 0 ? void 0 : _a.toString()) === 'Symbol(react.forward_ref)');\n}\nclass ReactRenderer {\n  constructor(component, {\n    editor,\n    props = {},\n    as = 'div',\n    className = '',\n    attrs\n  }) {\n    this.ref = null;\n    this.id = Math.floor(Math.random() * 0xFFFFFFFF).toString();\n    this.component = component;\n    this.editor = editor;\n    this.props = props;\n    this.element = document.createElement(as);\n    this.element.classList.add('react-renderer');\n    if (className) {\n      this.element.classList.add(...className.split(' '));\n    }\n    if (attrs) {\n      Object.keys(attrs).forEach(key => {\n        this.element.setAttribute(key, attrs[key]);\n      });\n    }\n    this.render();\n  }\n  render() {\n    var _a, _b;\n    const Component = this.component;\n    const props = this.props;\n    if (isClassComponent(Component) || isForwardRefComponent(Component)) {\n      props.ref = ref => {\n        this.ref = ref;\n      };\n    }\n    this.reactElement = React.createElement(Component, {\n      ...props\n    });\n    (_b = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.contentComponent) === null || _b === void 0 ? void 0 : _b.setRenderer(this.id, this);\n  }\n  updateProps(props = {}) {\n    this.props = {\n      ...this.props,\n      ...props\n    };\n    this.render();\n  }\n  destroy() {\n    var _a, _b;\n    (_b = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.contentComponent) === null || _b === void 0 ? void 0 : _b.removeRenderer(this.id);\n  }\n}\nclass ReactNodeView extends NodeView {\n  mount() {\n    const props = {\n      editor: this.editor,\n      node: this.node,\n      decorations: this.decorations,\n      selected: false,\n      extension: this.extension,\n      getPos: () => this.getPos(),\n      updateAttributes: (attributes = {}) => this.updateAttributes(attributes),\n      deleteNode: () => this.deleteNode()\n    };\n    if (!this.component.displayName) {\n      const capitalizeFirstChar = string => {\n        return string.charAt(0).toUpperCase() + string.substring(1);\n      };\n      this.component.displayName = capitalizeFirstChar(this.extension.name);\n    }\n    const ReactNodeViewProvider = componentProps => {\n      const Component = this.component;\n      const onDragStart = this.onDragStart.bind(this);\n      const nodeViewContentRef = element => {\n        if (element && this.contentDOMElement && element.firstChild !== this.contentDOMElement) {\n          element.appendChild(this.contentDOMElement);\n        }\n      };\n      return React.createElement(React.Fragment, null, React.createElement(ReactNodeViewContext.Provider, {\n        value: {\n          onDragStart,\n          nodeViewContentRef\n        }\n      }, React.createElement(Component, {\n        ...componentProps\n      })));\n    };\n    ReactNodeViewProvider.displayName = 'ReactNodeView';\n    if (this.node.isLeaf) {\n      this.contentDOMElement = null;\n    } else if (this.options.contentDOMElementTag) {\n      this.contentDOMElement = document.createElement(this.options.contentDOMElementTag);\n    } else {\n      this.contentDOMElement = document.createElement(this.node.isInline ? 'span' : 'div');\n    }\n    if (this.contentDOMElement) {\n      // For some reason the whiteSpace prop is not inherited properly in Chrome and Safari\n      // With this fix it seems to work fine\n      // See: https://github.com/ueberdosis/tiptap/issues/1197\n      this.contentDOMElement.style.whiteSpace = 'inherit';\n    }\n    let as = this.node.isInline ? 'span' : 'div';\n    if (this.options.as) {\n      as = this.options.as;\n    }\n    const {\n      className = ''\n    } = this.options;\n    this.handleSelectionUpdate = this.handleSelectionUpdate.bind(this);\n    this.editor.on('selectionUpdate', this.handleSelectionUpdate);\n    this.renderer = new ReactRenderer(ReactNodeViewProvider, {\n      editor: this.editor,\n      props,\n      as,\n      className: `node-${this.node.type.name} ${className}`.trim(),\n      attrs: this.options.attrs\n    });\n  }\n  get dom() {\n    var _a;\n    if (this.renderer.element.firstElementChild && !((_a = this.renderer.element.firstElementChild) === null || _a === void 0 ? void 0 : _a.hasAttribute('data-node-view-wrapper'))) {\n      throw Error('Please use the NodeViewWrapper component for your node view.');\n    }\n    return this.renderer.element;\n  }\n  get contentDOM() {\n    if (this.node.isLeaf) {\n      return null;\n    }\n    return this.contentDOMElement;\n  }\n  handleSelectionUpdate() {\n    const {\n      from,\n      to\n    } = this.editor.state.selection;\n    if (from <= this.getPos() && to >= this.getPos() + this.node.nodeSize) {\n      if (this.renderer.props.selected) {\n        return;\n      }\n      this.selectNode();\n    } else {\n      if (!this.renderer.props.selected) {\n        return;\n      }\n      this.deselectNode();\n    }\n  }\n  update(node, decorations) {\n    const updateProps = props => {\n      this.renderer.updateProps(props);\n    };\n    if (node.type !== this.node.type) {\n      return false;\n    }\n    if (typeof this.options.update === 'function') {\n      const oldNode = this.node;\n      const oldDecorations = this.decorations;\n      this.node = node;\n      this.decorations = decorations;\n      return this.options.update({\n        oldNode,\n        oldDecorations,\n        newNode: node,\n        newDecorations: decorations,\n        updateProps: () => updateProps({\n          node,\n          decorations\n        })\n      });\n    }\n    if (node === this.node && this.decorations === decorations) {\n      return true;\n    }\n    this.node = node;\n    this.decorations = decorations;\n    updateProps({\n      node,\n      decorations\n    });\n    return true;\n  }\n  selectNode() {\n    this.renderer.updateProps({\n      selected: true\n    });\n    this.renderer.element.classList.add('ProseMirror-selectednode');\n  }\n  deselectNode() {\n    this.renderer.updateProps({\n      selected: false\n    });\n    this.renderer.element.classList.remove('ProseMirror-selectednode');\n  }\n  destroy() {\n    this.renderer.destroy();\n    this.editor.off('selectionUpdate', this.handleSelectionUpdate);\n    this.contentDOMElement = null;\n  }\n}\nfunction ReactNodeViewRenderer(component, options) {\n  return props => {\n    // try to get the parent component\n    // this is important for vue devtools to show the component hierarchy correctly\n    // maybe it’s `undefined` because <editor-content> isn’t rendered yet\n    if (!props.editor.contentComponent) {\n      return {};\n    }\n    return new ReactNodeView(component, props, options);\n  };\n}\nexport { BubbleMenu, Editor, EditorConsumer, EditorContent, EditorContext, EditorProvider, FloatingMenu, NodeViewContent, NodeViewWrapper, PureEditorContent, ReactNodeViewRenderer, ReactRenderer, useCurrentEditor, useEditor };","map":{"version":3,"names":["mergeRefs","refs","node","forEach","ref","current","Portals","renderers","React","createElement","Fragment","Object","entries","map","key","renderer","ReactDOM","createPortal","reactElement","element","PureEditorContent","Component","constructor","props","editorContentRef","createRef","initialized","state","componentDidMount","init","componentDidUpdate","editor","options","contentComponent","append","childNodes","setOptions","createNodeViews","maybeFlushSync","fn","flushSync","setRenderer","id","setState","removeRenderer","nextRenderers","componentWillUnmount","isDestroyed","view","setProps","nodeViews","firstChild","newElement","document","render","innerRef","rest","EditorContentWithKey","forwardRef","useMemo","Math","floor","random","toString","EditorContent","memo","Editor","Editor$1","useEditor","deps","editorRef","useRef","forceUpdate","useState","onBeforeCreate","onBlur","onCreate","onDestroy","onFocus","onSelectionUpdate","onTransaction","onUpdate","onBeforeCreateRef","onBlurRef","onCreateRef","onDestroyRef","onFocusRef","onSelectionUpdateRef","onTransactionRef","onUpdateRef","useEffect","off","on","isMounted","requestAnimationFrame","_a","destroy","EditorContext","createContext","EditorConsumer","Consumer","useCurrentEditor","useContext","EditorProvider","children","slotAfter","slotBefore","editorOptions","Provider","value","currentEditor","BubbleMenu","setElement","pluginKey","tippyOptions","updateDelay","shouldShow","menuEditor","console","warn","plugin","BubbleMenuPlugin","registerPlugin","unregisterPlugin","className","style","visibility","FloatingMenu","FloatingMenuPlugin","ReactNodeViewContext","onDragStart","undefined","useReactNodeView","NodeViewContent","Tag","as","nodeViewContentRef","whiteSpace","NodeViewWrapper","isClassComponent","prototype","isReactComponent","isForwardRefComponent","$$typeof","ReactRenderer","component","attrs","classList","add","split","keys","setAttribute","_b","updateProps","ReactNodeView","NodeView","mount","decorations","selected","extension","getPos","updateAttributes","attributes","deleteNode","displayName","capitalizeFirstChar","string","charAt","toUpperCase","substring","name","ReactNodeViewProvider","componentProps","bind","contentDOMElement","appendChild","isLeaf","contentDOMElementTag","isInline","handleSelectionUpdate","type","trim","dom","firstElementChild","hasAttribute","Error","contentDOM","from","to","selection","nodeSize","selectNode","deselectNode","update","oldNode","oldDecorations","newNode","newDecorations","remove","ReactNodeViewRenderer"],"sources":["/home/gleb/my_app_test/node_modules/@tiptap/react/src/EditorContent.tsx","/home/gleb/my_app_test/node_modules/@tiptap/react/src/Editor.ts","/home/gleb/my_app_test/node_modules/@tiptap/react/src/useEditor.ts","/home/gleb/my_app_test/node_modules/@tiptap/react/src/Context.tsx","/home/gleb/my_app_test/node_modules/@tiptap/react/src/BubbleMenu.tsx","/home/gleb/my_app_test/node_modules/@tiptap/react/src/FloatingMenu.tsx","/home/gleb/my_app_test/node_modules/@tiptap/react/src/useReactNodeView.ts","/home/gleb/my_app_test/node_modules/@tiptap/react/src/NodeViewContent.tsx","/home/gleb/my_app_test/node_modules/@tiptap/react/src/NodeViewWrapper.tsx","/home/gleb/my_app_test/node_modules/@tiptap/react/src/ReactRenderer.tsx","/home/gleb/my_app_test/node_modules/@tiptap/react/src/ReactNodeViewRenderer.tsx"],"sourcesContent":["import React, {\n  ForwardedRef, forwardRef, HTMLProps, LegacyRef, MutableRefObject,\n} from 'react'\nimport ReactDOM, { flushSync } from 'react-dom'\n\nimport { Editor } from './Editor.js'\nimport { ReactRenderer } from './ReactRenderer.js'\n\nconst mergeRefs = <T extends HTMLDivElement>(\n  ...refs: Array<MutableRefObject<T> | LegacyRef<T> | undefined>\n) => {\n  return (node: T) => {\n    refs.forEach(ref => {\n      if (typeof ref === 'function') {\n        ref(node)\n      } else if (ref) {\n        (ref as MutableRefObject<T | null>).current = node\n      }\n    })\n  }\n}\n\nconst Portals: React.FC<{ renderers: Record<string, ReactRenderer> }> = ({ renderers }) => {\n  return (\n    <>\n      {Object.entries(renderers).map(([key, renderer]) => {\n        return ReactDOM.createPortal(renderer.reactElement, renderer.element, key)\n      })}\n    </>\n  )\n}\n\nexport interface EditorContentProps extends HTMLProps<HTMLDivElement> {\n  editor: Editor | null;\n  innerRef?: ForwardedRef<HTMLDivElement | null>;\n}\n\nexport interface EditorContentState {\n  renderers: Record<string, ReactRenderer>;\n}\n\nexport class PureEditorContent extends React.Component<EditorContentProps, EditorContentState> {\n  editorContentRef: React.RefObject<any>\n\n  initialized: boolean\n\n  constructor(props: EditorContentProps) {\n    super(props)\n    this.editorContentRef = React.createRef()\n    this.initialized = false\n\n    this.state = {\n      renderers: {},\n    }\n  }\n\n  componentDidMount() {\n    this.init()\n  }\n\n  componentDidUpdate() {\n    this.init()\n  }\n\n  init() {\n    const { editor } = this.props\n\n    if (editor && editor.options.element) {\n      if (editor.contentComponent) {\n        return\n      }\n\n      const element = this.editorContentRef.current\n\n      element.append(...editor.options.element.childNodes)\n\n      editor.setOptions({\n        element,\n      })\n\n      editor.contentComponent = this\n\n      editor.createNodeViews()\n\n      this.initialized = true\n    }\n  }\n\n  maybeFlushSync(fn: () => void) {\n    // Avoid calling flushSync until the editor is initialized.\n    // Initialization happens during the componentDidMount or componentDidUpdate\n    // lifecycle methods, and React doesn't allow calling flushSync from inside\n    // a lifecycle method.\n    if (this.initialized) {\n      flushSync(fn)\n    } else {\n      fn()\n    }\n  }\n\n  setRenderer(id: string, renderer: ReactRenderer) {\n    this.maybeFlushSync(() => {\n      this.setState(({ renderers }) => ({\n        renderers: {\n          ...renderers,\n          [id]: renderer,\n        },\n      }))\n    })\n  }\n\n  removeRenderer(id: string) {\n    this.maybeFlushSync(() => {\n      this.setState(({ renderers }) => {\n        const nextRenderers = { ...renderers }\n\n        delete nextRenderers[id]\n\n        return { renderers: nextRenderers }\n      })\n    })\n  }\n\n  componentWillUnmount() {\n    const { editor } = this.props\n\n    if (!editor) {\n      return\n    }\n\n    this.initialized = false\n\n    if (!editor.isDestroyed) {\n      editor.view.setProps({\n        nodeViews: {},\n      })\n    }\n\n    editor.contentComponent = null\n\n    if (!editor.options.element.firstChild) {\n      return\n    }\n\n    const newElement = document.createElement('div')\n\n    newElement.append(...editor.options.element.childNodes)\n\n    editor.setOptions({\n      element: newElement,\n    })\n  }\n\n  render() {\n    const { editor, innerRef, ...rest } = this.props\n\n    return (\n      <>\n        <div ref={mergeRefs(innerRef, this.editorContentRef)} {...rest} />\n        {/* @ts-ignore */}\n        <Portals renderers={this.state.renderers} />\n      </>\n    )\n  }\n}\n\n// EditorContent should be re-created whenever the Editor instance changes\nconst EditorContentWithKey = forwardRef<HTMLDivElement, EditorContentProps>(\n  (props: Omit<EditorContentProps, 'innerRef'>, ref) => {\n    const key = React.useMemo(() => {\n      return Math.floor(Math.random() * 0xFFFFFFFF).toString()\n    }, [props.editor])\n\n    // Can't use JSX here because it conflicts with the type definition of Vue's JSX, so use createElement\n    return React.createElement(PureEditorContent, {\n      key,\n      innerRef: ref,\n      ...props,\n    })\n  },\n)\n\nexport const EditorContent = React.memo(EditorContentWithKey)\n","import { Editor as CoreEditor } from '@tiptap/core'\nimport React from 'react'\n\nimport { EditorContentProps, EditorContentState } from './EditorContent.js'\nimport { ReactRenderer } from './ReactRenderer.js'\n\ntype ContentComponent = React.Component<EditorContentProps, EditorContentState> & {\n  setRenderer(id: string, renderer: ReactRenderer): void;\n  removeRenderer(id: string): void;\n}\n\nexport class Editor extends CoreEditor {\n  public contentComponent: ContentComponent | null = null\n}\n","import { EditorOptions } from '@tiptap/core'\nimport {\n  DependencyList,\n  useEffect,\n  useRef,\n  useState,\n} from 'react'\n\nimport { Editor } from './Editor.js'\n\nexport const useEditor = (options: Partial<EditorOptions> = {}, deps: DependencyList = []) => {\n  const editorRef = useRef<Editor | null>(null)\n  const [, forceUpdate] = useState({})\n\n  const {\n    onBeforeCreate,\n    onBlur,\n    onCreate,\n    onDestroy,\n    onFocus,\n    onSelectionUpdate,\n    onTransaction,\n    onUpdate,\n  } = options\n\n  const onBeforeCreateRef = useRef(onBeforeCreate)\n  const onBlurRef = useRef(onBlur)\n  const onCreateRef = useRef(onCreate)\n  const onDestroyRef = useRef(onDestroy)\n  const onFocusRef = useRef(onFocus)\n  const onSelectionUpdateRef = useRef(onSelectionUpdate)\n  const onTransactionRef = useRef(onTransaction)\n  const onUpdateRef = useRef(onUpdate)\n\n  // This effect will handle updating the editor instance\n  // when the event handlers change.\n  useEffect(() => {\n    if (!editorRef.current) {\n      return\n    }\n\n    if (onBeforeCreate) {\n      editorRef.current.off('beforeCreate', onBeforeCreateRef.current)\n      editorRef.current.on('beforeCreate', onBeforeCreate)\n\n      onBeforeCreateRef.current = onBeforeCreate\n    }\n\n    if (onBlur) {\n      editorRef.current.off('blur', onBlurRef.current)\n      editorRef.current.on('blur', onBlur)\n\n      onBlurRef.current = onBlur\n    }\n\n    if (onCreate) {\n      editorRef.current.off('create', onCreateRef.current)\n      editorRef.current.on('create', onCreate)\n\n      onCreateRef.current = onCreate\n    }\n\n    if (onDestroy) {\n      editorRef.current.off('destroy', onDestroyRef.current)\n      editorRef.current.on('destroy', onDestroy)\n\n      onDestroyRef.current = onDestroy\n    }\n\n    if (onFocus) {\n      editorRef.current.off('focus', onFocusRef.current)\n      editorRef.current.on('focus', onFocus)\n\n      onFocusRef.current = onFocus\n    }\n\n    if (onSelectionUpdate) {\n      editorRef.current.off('selectionUpdate', onSelectionUpdateRef.current)\n      editorRef.current.on('selectionUpdate', onSelectionUpdate)\n\n      onSelectionUpdateRef.current = onSelectionUpdate\n    }\n\n    if (onTransaction) {\n      editorRef.current.off('transaction', onTransactionRef.current)\n      editorRef.current.on('transaction', onTransaction)\n\n      onTransactionRef.current = onTransaction\n    }\n\n    if (onUpdate) {\n      editorRef.current.off('update', onUpdateRef.current)\n      editorRef.current.on('update', onUpdate)\n\n      onUpdateRef.current = onUpdate\n    }\n  }, [onBeforeCreate, onBlur, onCreate, onDestroy, onFocus, onSelectionUpdate, onTransaction, onUpdate, editorRef.current])\n\n  useEffect(() => {\n    let isMounted = true\n\n    editorRef.current = new Editor(options)\n\n    editorRef.current.on('transaction', () => {\n      requestAnimationFrame(() => {\n        requestAnimationFrame(() => {\n          if (isMounted) {\n            forceUpdate({})\n          }\n        })\n      })\n    })\n\n    return () => {\n      isMounted = false\n    }\n  }, deps)\n\n  useEffect(() => {\n    return () => {\n      return editorRef.current?.destroy()\n    }\n  }, [])\n\n  return editorRef.current\n}\n","import { EditorOptions } from '@tiptap/core'\nimport React, { createContext, ReactNode, useContext } from 'react'\n\nimport { Editor } from './Editor.js'\nimport { EditorContent } from './EditorContent.js'\nimport { useEditor } from './useEditor.js'\n\nexport type EditorContextValue = {\n  editor: Editor | null;\n}\n\nexport const EditorContext = createContext<EditorContextValue>({\n  editor: null,\n})\n\nexport const EditorConsumer = EditorContext.Consumer\n\nexport const useCurrentEditor = () => useContext(EditorContext)\n\nexport type EditorProviderProps = {\n  children: ReactNode;\n  slotBefore?: ReactNode;\n  slotAfter?: ReactNode;\n} & Partial<EditorOptions>\n\nexport const EditorProvider = ({\n  children, slotAfter, slotBefore, ...editorOptions\n}: EditorProviderProps) => {\n  const editor = useEditor(editorOptions)\n\n  if (!editor) {\n    return null\n  }\n\n  return (\n    <EditorContext.Provider value={{ editor }}>\n      {slotBefore}\n      <EditorConsumer>\n        {({ editor: currentEditor }) => (\n          <EditorContent editor={currentEditor} />\n        )}\n      </EditorConsumer>\n      {children}\n      {slotAfter}\n    </EditorContext.Provider>\n  )\n}\n","import { BubbleMenuPlugin, BubbleMenuPluginProps } from '@tiptap/extension-bubble-menu'\nimport React, { useEffect, useState } from 'react'\n\nimport { useCurrentEditor } from './Context.js'\n\ntype Optional<T, K extends keyof T> = Pick<Partial<T>, K> & Omit<T, K>;\n\nexport type BubbleMenuProps = Omit<Optional<BubbleMenuPluginProps, 'pluginKey' | 'editor'>, 'element'> & {\n  className?: string;\n  children: React.ReactNode;\n  updateDelay?: number;\n};\n\nexport const BubbleMenu = (props: BubbleMenuProps) => {\n  const [element, setElement] = useState<HTMLDivElement | null>(null)\n  const { editor: currentEditor } = useCurrentEditor()\n\n  useEffect(() => {\n    if (!element) {\n      return\n    }\n\n    if (props.editor?.isDestroyed || currentEditor?.isDestroyed) {\n      return\n    }\n\n    const {\n      pluginKey = 'bubbleMenu', editor, tippyOptions = {}, updateDelay, shouldShow = null,\n    } = props\n\n    const menuEditor = editor || currentEditor\n\n    if (!menuEditor) {\n      console.warn('BubbleMenu component is not rendered inside of an editor component or does not have editor prop.')\n      return\n    }\n\n    const plugin = BubbleMenuPlugin({\n      updateDelay,\n      editor: menuEditor,\n      element,\n      pluginKey,\n      shouldShow,\n      tippyOptions,\n    })\n\n    menuEditor.registerPlugin(plugin)\n    return () => menuEditor.unregisterPlugin(pluginKey)\n  }, [props.editor, currentEditor, element])\n\n  return (\n    <div ref={setElement} className={props.className} style={{ visibility: 'hidden' }}>\n      {props.children}\n    </div>\n  )\n}\n","import { FloatingMenuPlugin, FloatingMenuPluginProps } from '@tiptap/extension-floating-menu'\nimport React, {\n  useEffect, useState,\n} from 'react'\n\nimport { useCurrentEditor } from './Context.js'\n\ntype Optional<T, K extends keyof T> = Pick<Partial<T>, K> & Omit<T, K>\n\nexport type FloatingMenuProps = Omit<Optional<FloatingMenuPluginProps, 'pluginKey' | 'editor'>, 'element'> & {\n  className?: string,\n  children: React.ReactNode\n}\n\nexport const FloatingMenu = (props: FloatingMenuProps) => {\n  const [element, setElement] = useState<HTMLDivElement | null>(null)\n  const { editor: currentEditor } = useCurrentEditor()\n\n  useEffect(() => {\n    if (!element) {\n      return\n    }\n\n    if (props.editor?.isDestroyed || currentEditor?.isDestroyed) {\n      return\n    }\n\n    const {\n      pluginKey = 'floatingMenu',\n      editor,\n      tippyOptions = {},\n      shouldShow = null,\n    } = props\n\n    const menuEditor = editor || currentEditor\n\n    if (!menuEditor) {\n      console.warn('FloatingMenu component is not rendered inside of an editor component or does not have editor prop.')\n      return\n    }\n\n    const plugin = FloatingMenuPlugin({\n      pluginKey,\n      editor: menuEditor,\n      element,\n      tippyOptions,\n      shouldShow,\n    })\n\n    menuEditor.registerPlugin(plugin)\n    return () => menuEditor.unregisterPlugin(pluginKey)\n  }, [\n    props.editor,\n    currentEditor,\n    element,\n  ])\n\n  return (\n    <div ref={setElement} className={props.className} style={{ visibility: 'hidden' }}>\n      {props.children}\n    </div>\n  )\n}\n","import { createContext, useContext } from 'react'\n\nexport interface ReactNodeViewContextProps {\n  onDragStart: (event: DragEvent) => void,\n  nodeViewContentRef: (element: HTMLElement | null) => void,\n}\n\nexport const ReactNodeViewContext = createContext<Partial<ReactNodeViewContextProps>>({\n  onDragStart: undefined,\n})\n\nexport const useReactNodeView = () => useContext(ReactNodeViewContext)\n","import React from 'react'\n\nimport { useReactNodeView } from './useReactNodeView.js'\n\nexport interface NodeViewContentProps {\n  [key: string]: any,\n  as?: React.ElementType,\n}\n\nexport const NodeViewContent: React.FC<NodeViewContentProps> = props => {\n  const Tag = props.as || 'div'\n  const { nodeViewContentRef } = useReactNodeView()\n\n  return (\n    <Tag\n      {...props}\n      ref={nodeViewContentRef}\n      data-node-view-content=\"\"\n      style={{\n        whiteSpace: 'pre-wrap',\n        ...props.style,\n      }}\n    />\n  )\n}\n","import React from 'react'\n\nimport { useReactNodeView } from './useReactNodeView.js'\n\nexport interface NodeViewWrapperProps {\n  [key: string]: any,\n  as?: React.ElementType,\n}\n\nexport const NodeViewWrapper: React.FC<NodeViewWrapperProps> = React.forwardRef((props, ref) => {\n  const { onDragStart } = useReactNodeView()\n  const Tag = props.as || 'div'\n\n  return (\n    <Tag\n      {...props}\n      ref={ref}\n      data-node-view-wrapper=\"\"\n      onDragStart={onDragStart}\n      style={{\n        whiteSpace: 'normal',\n        ...props.style,\n      }}\n    />\n  )\n})\n","import { Editor } from '@tiptap/core'\nimport React from 'react'\n\nimport { Editor as ExtendedEditor } from './Editor.js'\n\nfunction isClassComponent(Component: any) {\n  return !!(\n    typeof Component === 'function'\n    && Component.prototype\n    && Component.prototype.isReactComponent\n  )\n}\n\nfunction isForwardRefComponent(Component: any) {\n  return !!(\n    typeof Component === 'object'\n    && Component.$$typeof?.toString() === 'Symbol(react.forward_ref)'\n  )\n}\n\nexport interface ReactRendererOptions {\n  editor: Editor,\n  props?: Record<string, any>,\n  as?: string,\n  className?: string,\n  attrs?: Record<string, string>,\n}\n\ntype ComponentType<R, P> =\n  React.ComponentClass<P> |\n  React.FunctionComponent<P> |\n  React.ForwardRefExoticComponent<React.PropsWithoutRef<P> & React.RefAttributes<R>>;\n\nexport class ReactRenderer<R = unknown, P = unknown> {\n  id: string\n\n  editor: ExtendedEditor\n\n  component: any\n\n  element: Element\n\n  props: Record<string, any>\n\n  reactElement: React.ReactNode\n\n  ref: R | null = null\n\n  constructor(component: ComponentType<R, P>, {\n    editor,\n    props = {},\n    as = 'div',\n    className = '',\n    attrs,\n  }: ReactRendererOptions) {\n    this.id = Math.floor(Math.random() * 0xFFFFFFFF).toString()\n    this.component = component\n    this.editor = editor as ExtendedEditor\n    this.props = props\n    this.element = document.createElement(as)\n    this.element.classList.add('react-renderer')\n\n    if (className) {\n      this.element.classList.add(...className.split(' '))\n    }\n\n    if (attrs) {\n      Object.keys(attrs).forEach(key => {\n        this.element.setAttribute(key, attrs[key])\n      })\n    }\n\n    this.render()\n  }\n\n  render(): void {\n    const Component = this.component\n    const props = this.props\n\n    if (isClassComponent(Component) || isForwardRefComponent(Component)) {\n      props.ref = (ref: R) => {\n        this.ref = ref\n      }\n    }\n\n    this.reactElement = <Component {...props } />\n\n    this.editor?.contentComponent?.setRenderer(this.id, this)\n  }\n\n  updateProps(props: Record<string, any> = {}): void {\n    this.props = {\n      ...this.props,\n      ...props,\n    }\n\n    this.render()\n  }\n\n  destroy(): void {\n    this.editor?.contentComponent?.removeRenderer(this.id)\n  }\n}\n","import {\n  DecorationWithType,\n  NodeView,\n  NodeViewProps,\n  NodeViewRenderer,\n  NodeViewRendererOptions,\n  NodeViewRendererProps,\n} from '@tiptap/core'\nimport { Node as ProseMirrorNode } from '@tiptap/pm/model'\nimport { Decoration, NodeView as ProseMirrorNodeView } from '@tiptap/pm/view'\nimport React from 'react'\n\nimport { Editor } from './Editor.js'\nimport { ReactRenderer } from './ReactRenderer.js'\nimport { ReactNodeViewContext, ReactNodeViewContextProps } from './useReactNodeView.js'\n\nexport interface ReactNodeViewRendererOptions extends NodeViewRendererOptions {\n  update:\n    | ((props: {\n        oldNode: ProseMirrorNode\n        oldDecorations: Decoration[]\n        newNode: ProseMirrorNode\n        newDecorations: Decoration[]\n        updateProps: () => void\n      }) => boolean)\n    | null\n  as?: string\n  className?: string\n  attrs?: Record<string, string>\n}\n\nclass ReactNodeView extends NodeView<\n  React.FunctionComponent,\n  Editor,\n  ReactNodeViewRendererOptions\n> {\n  renderer!: ReactRenderer\n\n  contentDOMElement!: HTMLElement | null\n\n  mount() {\n    const props: NodeViewProps = {\n      editor: this.editor,\n      node: this.node,\n      decorations: this.decorations,\n      selected: false,\n      extension: this.extension,\n      getPos: () => this.getPos(),\n      updateAttributes: (attributes = {}) => this.updateAttributes(attributes),\n      deleteNode: () => this.deleteNode(),\n    }\n\n    if (!(this.component as any).displayName) {\n      const capitalizeFirstChar = (string: string): string => {\n        return string.charAt(0).toUpperCase() + string.substring(1)\n      }\n\n      this.component.displayName = capitalizeFirstChar(this.extension.name)\n    }\n\n    const ReactNodeViewProvider: React.FunctionComponent = componentProps => {\n      const Component = this.component\n      const onDragStart = this.onDragStart.bind(this)\n      const nodeViewContentRef: ReactNodeViewContextProps['nodeViewContentRef'] = element => {\n        if (element && this.contentDOMElement && element.firstChild !== this.contentDOMElement) {\n          element.appendChild(this.contentDOMElement)\n        }\n      }\n\n      return (\n        <>\n          {/* @ts-ignore */}\n          <ReactNodeViewContext.Provider value={{ onDragStart, nodeViewContentRef }}>\n            {/* @ts-ignore */}\n            <Component {...componentProps} />\n          </ReactNodeViewContext.Provider>\n        </>\n      )\n    }\n\n    ReactNodeViewProvider.displayName = 'ReactNodeView'\n\n    if (this.node.isLeaf) {\n      this.contentDOMElement = null\n    } else if (this.options.contentDOMElementTag) {\n      this.contentDOMElement = document.createElement(this.options.contentDOMElementTag)\n    } else {\n      this.contentDOMElement = document.createElement(this.node.isInline ? 'span' : 'div')\n    }\n\n    if (this.contentDOMElement) {\n      // For some reason the whiteSpace prop is not inherited properly in Chrome and Safari\n      // With this fix it seems to work fine\n      // See: https://github.com/ueberdosis/tiptap/issues/1197\n      this.contentDOMElement.style.whiteSpace = 'inherit'\n    }\n\n    let as = this.node.isInline ? 'span' : 'div'\n\n    if (this.options.as) {\n      as = this.options.as\n    }\n\n    const { className = '' } = this.options\n\n    this.handleSelectionUpdate = this.handleSelectionUpdate.bind(this)\n    this.editor.on('selectionUpdate', this.handleSelectionUpdate)\n\n    this.renderer = new ReactRenderer(ReactNodeViewProvider, {\n      editor: this.editor,\n      props,\n      as,\n      className: `node-${this.node.type.name} ${className}`.trim(),\n      attrs: this.options.attrs,\n    })\n  }\n\n  get dom() {\n    if (\n      this.renderer.element.firstElementChild\n      && !this.renderer.element.firstElementChild?.hasAttribute('data-node-view-wrapper')\n    ) {\n      throw Error('Please use the NodeViewWrapper component for your node view.')\n    }\n\n    return this.renderer.element as HTMLElement\n  }\n\n  get contentDOM() {\n    if (this.node.isLeaf) {\n      return null\n    }\n\n    return this.contentDOMElement\n  }\n\n  handleSelectionUpdate() {\n    const { from, to } = this.editor.state.selection\n\n    if (from <= this.getPos() && to >= this.getPos() + this.node.nodeSize) {\n      if (this.renderer.props.selected) {\n        return\n      }\n\n      this.selectNode()\n    } else {\n      if (!this.renderer.props.selected) {\n        return\n      }\n\n      this.deselectNode()\n    }\n  }\n\n  update(node: ProseMirrorNode, decorations: DecorationWithType[]) {\n    const updateProps = (props?: Record<string, any>) => {\n      this.renderer.updateProps(props)\n    }\n\n    if (node.type !== this.node.type) {\n      return false\n    }\n\n    if (typeof this.options.update === 'function') {\n      const oldNode = this.node\n      const oldDecorations = this.decorations\n\n      this.node = node\n      this.decorations = decorations\n\n      return this.options.update({\n        oldNode,\n        oldDecorations,\n        newNode: node,\n        newDecorations: decorations,\n        updateProps: () => updateProps({ node, decorations }),\n      })\n    }\n\n    if (node === this.node && this.decorations === decorations) {\n      return true\n    }\n\n    this.node = node\n    this.decorations = decorations\n\n    updateProps({ node, decorations })\n\n    return true\n  }\n\n  selectNode() {\n    this.renderer.updateProps({\n      selected: true,\n    })\n    this.renderer.element.classList.add('ProseMirror-selectednode')\n  }\n\n  deselectNode() {\n    this.renderer.updateProps({\n      selected: false,\n    })\n    this.renderer.element.classList.remove('ProseMirror-selectednode')\n  }\n\n  destroy() {\n    this.renderer.destroy()\n    this.editor.off('selectionUpdate', this.handleSelectionUpdate)\n    this.contentDOMElement = null\n  }\n}\n\nexport function ReactNodeViewRenderer(\n  component: any,\n  options?: Partial<ReactNodeViewRendererOptions>,\n): NodeViewRenderer {\n  return (props: NodeViewRendererProps) => {\n    // try to get the parent component\n    // this is important for vue devtools to show the component hierarchy correctly\n    // maybe it’s `undefined` because <editor-content> isn’t rendered yet\n    if (!(props.editor as Editor).contentComponent) {\n      return {}\n    }\n\n    return new ReactNodeView(component, props, options) as unknown as ProseMirrorNodeView\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}