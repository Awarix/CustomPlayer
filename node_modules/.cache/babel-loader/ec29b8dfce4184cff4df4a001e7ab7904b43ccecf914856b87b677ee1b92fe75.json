{"ast":null,"code":"var _jsxFileName = \"/home/gleb/my_app_test/src/graph/NetworkDiagram.tsx\",\n  _s = $RefreshSig$();\nimport * as d3 from 'd3';\nimport { useEffect, useRef } from 'react';\nimport { RADIUS, drawNetwork } from './drawNetwork';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const NetworkDiagram = ({\n  width,\n  height,\n  data\n}) => {\n  _s();\n  // The force simulation mutates links and nodes, so create a copy first\n  // Node positions are initialized by d3\n  const links = data.links.map(d => ({\n    ...d\n  }));\n  const nodes = data.nodes.map(d => ({\n    ...d\n  }));\n  const canvasRef = useRef(null);\n  useEffect(() => {\n    // set dimension of the canvas element\n    const canvas = canvasRef.current;\n    const context = canvas === null || canvas === void 0 ? void 0 : canvas.getContext('2d');\n    if (!context) {\n      return;\n    }\n\n    // run d3-force to find the position of nodes on the canvas\n    d3.forceSimulation(nodes)\n\n    // list of forces we apply to get node positions\n    .force('link', d3.forceLink(links).id(d => d.id)).force('collide', d3.forceCollide().radius(RADIUS)).force('charge', d3.forceManyBody()).force('center', d3.forceCenter(width / 2, height / 2))\n\n    // at each iteration of the simulation, draw the network diagram with the new node positions\n    .on('tick', () => {\n      drawNetwork(context, width, height, nodes, links);\n    });\n  }, [width, height, nodes, links]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        width,\n        height\n      },\n      width: width,\n      height: height\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n};\n_s(NetworkDiagram, \"UJgi7ynoup7eqypjnwyX/s32POg=\");\n_c = NetworkDiagram;\nvar _c;\n$RefreshReg$(_c, \"NetworkDiagram\");","map":{"version":3,"names":["d3","useEffect","useRef","RADIUS","drawNetwork","jsxDEV","_jsxDEV","NetworkDiagram","width","height","data","_s","links","map","d","nodes","canvasRef","canvas","current","context","getContext","forceSimulation","force","forceLink","id","forceCollide","radius","forceManyBody","forceCenter","on","children","ref","style","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/gleb/my_app_test/src/graph/NetworkDiagram.tsx"],"sourcesContent":["import * as d3 from 'd3';\nimport { useEffect, useRef } from 'react';\nimport { RADIUS, drawNetwork } from './drawNetwork';\nimport { Data, Link, Node } from './data';\n\ntype NetworkDiagramProps = {\n  width: number;\n  height: number;\n  data: Data;\n};\n\nexport const NetworkDiagram = ({\n  width,\n  height,\n  data,\n}: NetworkDiagramProps) => {\n  // The force simulation mutates links and nodes, so create a copy first\n  // Node positions are initialized by d3\n  const links: Link[] = data.links.map((d) => ({ ...d }));\n  const nodes: Node[] = data.nodes.map((d) => ({ ...d }));\n\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    // set dimension of the canvas element\n    const canvas = canvasRef.current;\n    const context = canvas?.getContext('2d');\n\n    if (!context) {\n      return;\n    }\n\n    // run d3-force to find the position of nodes on the canvas\n    d3.forceSimulation(nodes)\n\n      // list of forces we apply to get node positions\n      .force(\n        'link',\n        d3.forceLink<Node, Link>(links).id((d) => d.id)\n      )\n      .force('collide', d3.forceCollide().radius(RADIUS))\n      .force('charge', d3.forceManyBody())\n      .force('center', d3.forceCenter(width / 2, height / 2))\n\n      // at each iteration of the simulation, draw the network diagram with the new node positions\n      .on('tick', () => {\n        drawNetwork(context, width, height, nodes, links);\n      });\n  }, [width, height, nodes, links]);\n\n  return (\n    <div>\n      <canvas\n        ref={canvasRef}\n        style={{\n          width,\n          height,\n        }}\n        width={width}\n        height={height}\n      />\n    </div>\n  );\n};\n"],"mappings":";;AAAA,OAAO,KAAKA,EAAE,MAAM,IAAI;AACxB,SAASC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AACzC,SAASC,MAAM,EAAEC,WAAW,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AASpD,OAAO,MAAMC,cAAc,GAAGA,CAAC;EAC7BC,KAAK;EACLC,MAAM;EACNC;AACmB,CAAC,KAAK;EAAAC,EAAA;EACzB;EACA;EACA,MAAMC,KAAa,GAAGF,IAAI,CAACE,KAAK,CAACC,GAAG,CAAEC,CAAC,KAAM;IAAE,GAAGA;EAAE,CAAC,CAAC,CAAC;EACvD,MAAMC,KAAa,GAAGL,IAAI,CAACK,KAAK,CAACF,GAAG,CAAEC,CAAC,KAAM;IAAE,GAAGA;EAAE,CAAC,CAAC,CAAC;EAEvD,MAAME,SAAS,GAAGd,MAAM,CAAoB,IAAI,CAAC;EAEjDD,SAAS,CAAC,MAAM;IACd;IACA,MAAMgB,MAAM,GAAGD,SAAS,CAACE,OAAO;IAChC,MAAMC,OAAO,GAAGF,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEG,UAAU,CAAC,IAAI,CAAC;IAExC,IAAI,CAACD,OAAO,EAAE;MACZ;IACF;;IAEA;IACAnB,EAAE,CAACqB,eAAe,CAACN,KAAK;;IAEtB;IAAA,CACCO,KAAK,CACJ,MAAM,EACNtB,EAAE,CAACuB,SAAS,CAAaX,KAAK,CAAC,CAACY,EAAE,CAAEV,CAAC,IAAKA,CAAC,CAACU,EAAE,CAChD,CAAC,CACAF,KAAK,CAAC,SAAS,EAAEtB,EAAE,CAACyB,YAAY,CAAC,CAAC,CAACC,MAAM,CAACvB,MAAM,CAAC,CAAC,CAClDmB,KAAK,CAAC,QAAQ,EAAEtB,EAAE,CAAC2B,aAAa,CAAC,CAAC,CAAC,CACnCL,KAAK,CAAC,QAAQ,EAAEtB,EAAE,CAAC4B,WAAW,CAACpB,KAAK,GAAG,CAAC,EAAEC,MAAM,GAAG,CAAC,CAAC;;IAEtD;IAAA,CACCoB,EAAE,CAAC,MAAM,EAAE,MAAM;MAChBzB,WAAW,CAACe,OAAO,EAAEX,KAAK,EAAEC,MAAM,EAAEM,KAAK,EAAEH,KAAK,CAAC;IACnD,CAAC,CAAC;EACN,CAAC,EAAE,CAACJ,KAAK,EAAEC,MAAM,EAAEM,KAAK,EAAEH,KAAK,CAAC,CAAC;EAEjC,oBACEN,OAAA;IAAAwB,QAAA,eACExB,OAAA;MACEyB,GAAG,EAAEf,SAAU;MACfgB,KAAK,EAAE;QACLxB,KAAK;QACLC;MACF,CAAE;MACFD,KAAK,EAAEA,KAAM;MACbC,MAAM,EAAEA;IAAO;MAAAwB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAChB;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV,CAAC;AAACzB,EAAA,CApDWJ,cAAc;AAAA8B,EAAA,GAAd9B,cAAc;AAAA,IAAA8B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}