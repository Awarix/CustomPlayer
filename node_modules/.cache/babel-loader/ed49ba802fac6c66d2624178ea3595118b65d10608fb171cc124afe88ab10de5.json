{"ast":null,"code":"var _jsxFileName = \"/home/gleb/my_app_test/src/audio/wavesurfer/WavePlayer.tsx\",\n  _s = $RefreshSig$();\nimport { useMemo, useRef, useState, useEffect, useCallback } from \"react\";\n\n// material ui\n// import { makeStyles, Theme } from \"@material-ui/core/styles\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport PlayCircleFilledIcon from \"@material-ui/icons/PlayCircleFilled\";\nimport PauseCircleFilledIcon from \"@material-ui/icons/PauseCircleFilled\";\nimport ZoomInIcon from \"@material-ui/icons/ZoomIn\";\nimport ZoomOutIcon from \"@material-ui/icons/ZoomOut\";\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\n\n// import FileService from \"services/FileService\";\n\n// import { Segment } from \"types/segment\";\n// import { File } from \"types/file\";\n\nimport { WaveSurfer, WaveForm, Region } from \"wavesurfer-react\";\nimport { currTimeSubscriber, changeSegmentPositionSubscriber } from \"../../subscribers/PlayerSubscriber\";\n\n// const WaveSurfer2 = require('wavesurfer.js');\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RegionsPlugin = require(\"wavesurfer.js/dist/plugin/wavesurfer.regions.min\");\nconst TimelinePlugin = require(\"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\");\n\n// import { WaveSurfer as WaveSurferRef } from \"../utils/createWavesurfer\";\n// import RegionsPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.regions.min\";\n// import TimelinePlugin from \"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\";\n// import CursorPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.cursor.min\";\n// import MyCustomPlugin from 'my-custom-plugin-path';\n\n// const useStyles = makeStyles((theme: Theme) => ({\n//   root: {\n//     // display: \"flex\",\n//     // alignItems: \"center\",\n//     // justifyContent: \"flex-End\",\n//   },\n//   container: {\n//     // display: \"flex\",\n//     // alignItems: \"center\",\n//     // cursor: \"pointer\",\n//   },\n// }));\n\nconst WavePlayer = ({\n  file,\n  segments,\n  activeSegmentProp,\n  url\n}) => {\n  _s();\n  // const dispatch = useDispatch();\n  // const classes = useStyles();\n  const [isPlay, setIsPlay] = useState(false);\n  const [autoCenter, setAutoCenter] = useState(true);\n  // const [isLoading, setIsLoading] = useState<boolean>(true);\n\n  const [zoom, setZoom] = useState(10);\n  const [regions, setRegions] = useState([]);\n  const [activeSegment, setActiveSegment] = useState(activeSegmentProp);\n\n  //   let url = FileService.getAudioUrl(!file ? \"\" : file.id);\n  //   if (!file) {\n  //     url = \"\";\n  //   }\n\n  const plugins = useMemo(() => {\n    return [{\n      plugin: RegionsPlugin,\n      options: {\n        dragSelection: false,\n        showTooltip: false\n      },\n      key: '2837123'\n    }, {\n      plugin: TimelinePlugin,\n      options: {\n        container: \"#timeline\"\n      },\n      key: '86829632163'\n    }].filter(Boolean);\n  }, []);\n  const wavesurferRef = useRef(null);\n  const handleWSMount = useCallback(waveSurfer => {\n    wavesurferRef.current = waveSurfer;\n    // wavesurferRef.current.normalize=true;\n    wavesurferRef.current.on(\"ready\", () => {\n      console.log(\"wavesurferRef event: ready\");\n      // setIsLoading(false);\n    });\n    wavesurferRef.current.on(\"region-update-End\", (s, event) => {\n      changeSegmentPositionSubscriber.next({\n        segment: s.data,\n        Start: s.Start,\n        End: s.End\n      });\n    });\n    let lastTime = 0;\n    wavesurferRef.current.on(\"audioprocess\", currentTime => {\n      const diff = Math.abs(currentTime - lastTime);\n      if (diff > 0.1) {\n        lastTime = currentTime;\n        currTimeSubscriber.next(currentTime);\n      }\n    });\n  }, []);\n  function setZoomClick(zoom) {\n    if (zoom < 5) {\n      zoom = 5;\n    }\n    if (zoom > 200) {\n      zoom = 200;\n    }\n\n    // console.log(`setZoomClick: ${zoom}`)\n\n    setZoom(zoom);\n  }\n  function downloadAudio() {\n    fetch(url).then(res => {\n      if (!file) {\n        return;\n      }\n      res.blob().then(blob => {\n        let name = file.name;\n        if (!name.endsWith(\".wav\")) {\n          name += \".wav\";\n        }\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement(\"a\");\n        a.href = url;\n        a.download = name;\n        a.click();\n        a.remove();\n      });\n    });\n  }\n\n  // обработчик нажатия клавиш\n  const handleKeyDown = useCallback(event => {\n    var _document$activeEleme, _document$activeEleme2;\n    if (!wavesurferRef.current) {\n      return;\n    }\n    const {\n      key,\n      ctrlKey\n    } = event;\n    let isNeedExKey = ((_document$activeEleme = document.activeElement) === null || _document$activeEleme === void 0 ? void 0 : _document$activeEleme.tagName) === \"TEXTAREA\";\n    isNeedExKey = isNeedExKey || ((_document$activeEleme2 = document.activeElement) === null || _document$activeEleme2 === void 0 ? void 0 : _document$activeEleme2.tagName) === \"INPUT\";\n    let isEx = true;\n    if (isNeedExKey) {\n      isEx = ctrlKey;\n    }\n    if (key === \" \" && isEx) {\n      setIsPlay(prev => !prev);\n    }\n    if ((key === \"w\" || key === \"s\") && isEx) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n    if ((key === \"a\" || key === \"d\" || key === \"ф\" || key === \"в\") && isEx) {\n      let diff = 5;\n      if (activeSegment !== null) diff = 1;\n      if (key === \"a\" || key === \"ф\") diff *= -1;\n      const total = wavesurferRef.current.getDuration();\n      let need = wavesurferRef.current.getCurrentTime() + diff;\n      if (need < 0) need = 0;\n      if (need > total) need = total;\n      if (activeSegment && need < activeSegment.Start - 1) need = activeSegment.Start - 1;\n      wavesurferRef.current.setCurrentTime(need);\n      setIsPlay(true);\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }, [activeSegment]);\n  useEffect(() => {\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => {\n      window.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [handleKeyDown]);\n  useEffect(() => {\n    let regions2 = segments.map(s => {\n      return {\n        // id: s.id,\n        Start: s.Start,\n        End: s.End,\n        color: \"#6ab4ff29\",\n        drag: false,\n        resize: true,\n        handleStyle: {\n          left: {\n            backgroundColor: \"transparent\",\n            width: \"5px\"\n          },\n          right: {\n            backgroundColor: \"transparent\",\n            width: \"5px\"\n          }\n        },\n        data: s\n      };\n    });\n    setRegions(regions2);\n  }, [segments]);\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n    setZoom(10);\n    if (url === \"\") {\n      return;\n    }\n\n    // if (!file) {\n    //   return;\n    // }\n\n    // FileService.filePeakById(file.id).then(({ data }) => {\n    //   wavesurferRef.current.load(url, data.data, false, file.duration);\n    //   wavesurferRef.current.setCurrentTime(0);\n    //   // setIsPlay(true);\n    // });\n\n    // wavesurferRef.current.setCurrentTime(3);\n  }, [file, url]);\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n    if (wavesurferRef.current.params.minPxPerSec !== zoom) {\n      wavesurferRef.current.zoom(zoom);\n    }\n  }, [zoom]);\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n    if (isPlay) {\n      wavesurferRef.current.play();\n    } else {\n      wavesurferRef.current.pause();\n    }\n  }, [isPlay]);\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n    wavesurferRef.current.setAutoCenter(autoCenter);\n  }, [autoCenter]);\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n    setActiveSegment(activeSegmentProp);\n    // console.log(activeSegmentProp);\n    // console.log(`setActiveSegment: ${activeSegmentProp?.Start}`);\n\n    if (activeSegmentProp) {\n      // console.log(`clientWidth : ${wavesurferRef.current.drawer.wrapper.clientWidth}`);\n      // console.log(`width : ${wavesurferRef.current.drawer.width}`);\n      let zoom = 200;\n      const width = wavesurferRef.current.drawer.wrapper.clientWidth;\n      const segmentDuration = activeSegmentProp.End - activeSegmentProp.Start;\n      for (let i = 0; i < 10; i++) {\n        if (segmentDuration * zoom < width) {\n          break;\n        }\n        zoom /= 2;\n      }\n      if (zoom < 5) {\n        zoom = 5;\n      }\n      setZoomClick(zoom);\n      setAutoCenter(false);\n      setIsPlay(true);\n      const total = wavesurferRef.current.getDuration();\n      // console.log(`total: ${total}`)\n      if (total > 0) {\n        const centerTime = activeSegmentProp.Start + (activeSegmentProp.End - activeSegmentProp.Start) / 2;\n        const t1 = centerTime / total;\n\n        // console.log(`centerTime: ${centerTime}. t1: ${t1}. zoom: ${zoom}`);\n        wavesurferRef.current.zoom(zoom);\n        wavesurferRef.current.seekAndCenter(t1);\n        wavesurferRef.current.setCurrentTime(activeSegmentProp.Start);\n        wavesurferRef.current.play();\n      }\n    }\n    for (let i = 0; i < regions.length; i++) {\n      if (regions[i].color !== \"#6ab4ff29\") {\n        regions[i] = {\n          ...regions[i],\n          color: \"#6ab4ff29\"\n        };\n      }\n      if ((activeSegmentProp === null || activeSegmentProp === void 0 ? void 0 : activeSegmentProp.id) === regions[i].id) {\n        regions[i] = {\n          ...regions[i],\n          color: \"#2692ff40\"\n        };\n      }\n    }\n\n    // setRegions([...regions]);\n\n    const test = currTimeSubscriber.subscribe(currentTime => {\n      if (wavesurferRef && activeSegmentProp && currentTime >= activeSegmentProp.End) {\n        wavesurferRef.current.setCurrentTime(activeSegmentProp.Start);\n      }\n    });\n    return () => {\n      test.unsubscribe();\n    };\n  }, [activeSegmentProp, regions]);\n  console.log(`AudioPlayer2 rEnder`);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: \"100%\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(WaveSurfer, {\n      onMount: handleWSMount\n      // src=\"https://freesound.org/data/previews/462/462807_8386274-lq.mp3\"\n      ,\n      container: \"hfsjdf\",\n      plugins: plugins,\n      children: [/*#__PURE__*/_jsxDEV(WaveForm, {\n        id: \"waveform\",\n        waveColor: \"#b1d0f1\",\n        progressColor: \"#b1d0f1\",\n        cursorColor: \"red\",\n        autoCenter: autoCenter,\n        children: regions.map(regionProps => /*#__PURE__*/_jsxDEV(Region, {\n          ...regionProps\n        }, regionProps.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: \"20px\"\n        },\n        id: \"timeline\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: \"40px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(IconButton, {\n        color: \"primary\",\n        onClick: e => {\n          document.activeElement.blur();\n          setIsPlay(prev => !prev);\n        },\n        children: isPlay ? /*#__PURE__*/_jsxDEV(PauseCircleFilledIcon, {\n          fontSize: \"medium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(PlayCircleFilledIcon, {\n          fontSize: \"medium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 67\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        color: \"primary\",\n        title: \"\\u0423\\u0432\\u0435\\u043B\\u0438\\u0447\\u0438\\u0442\\u044C \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\",\n        onClick: e => {\n          document.activeElement.blur();\n          setZoomClick(zoom * 2);\n        },\n        children: /*#__PURE__*/_jsxDEV(ZoomInIcon, {\n          fontSize: \"medium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        color: \"primary\",\n        title: \"\\u0423\\u043C\\u0435\\u043D\\u044C\\u0448\\u0438\\u0442\\u044C \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\",\n        onClick: e => {\n          document.activeElement.blur();\n          setZoomClick(zoom / 2);\n        },\n        children: /*#__PURE__*/_jsxDEV(ZoomOutIcon, {\n          fontSize: \"medium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        color: \"primary\",\n        title: \"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C \\u0430\\u0443\\u0434\\u0438\\u043E\",\n        onClick: e => {\n          document.activeElement.blur();\n          downloadAudio();\n        },\n        children: /*#__PURE__*/_jsxDEV(GetAppIcon, {\n          fontSize: \"medium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FormControlLabel, {\n        style: {\n          marginLeft: \"10px\"\n        },\n        onClick: e => {\n          document.activeElement.blur();\n        },\n        control: /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: autoCenter,\n          color: \"primary\",\n          onChange: event => {\n            setAutoCenter(event.target.checked);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 13\n        }, this),\n        label: \"\\u041F\\u043E\\u0437\\u0438\\u0446\\u0438\\u044F \\u043F\\u043E \\u0446\\u0435\\u043D\\u0442\\u0440\\u0443\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 344,\n    columnNumber: 5\n  }, this);\n};\n_s(WavePlayer, \"Rv2V1FQwX1NN7VL+iA4yXEtK7L8=\");\n_c = WavePlayer;\nexport default WavePlayer;\nvar _c;\n$RefreshReg$(_c, \"WavePlayer\");","map":{"version":3,"names":["useMemo","useRef","useState","useEffect","useCallback","IconButton","PlayCircleFilledIcon","PauseCircleFilledIcon","ZoomInIcon","ZoomOutIcon","GetAppIcon","Checkbox","FormControlLabel","WaveSurfer","WaveForm","Region","currTimeSubscriber","changeSegmentPositionSubscriber","jsxDEV","_jsxDEV","RegionsPlugin","require","TimelinePlugin","WavePlayer","file","segments","activeSegmentProp","url","_s","isPlay","setIsPlay","autoCenter","setAutoCenter","zoom","setZoom","regions","setRegions","activeSegment","setActiveSegment","plugins","plugin","options","dragSelection","showTooltip","key","container","filter","Boolean","wavesurferRef","handleWSMount","waveSurfer","current","on","console","log","s","event","next","segment","data","Start","End","lastTime","currentTime","diff","Math","abs","setZoomClick","downloadAudio","fetch","then","res","blob","name","endsWith","window","URL","createObjectURL","a","document","createElement","href","download","click","remove","handleKeyDown","_document$activeEleme","_document$activeEleme2","ctrlKey","isNeedExKey","activeElement","tagName","isEx","prev","preventDefault","stopPropagation","total","getDuration","need","getCurrentTime","setCurrentTime","addEventListener","removeEventListener","regions2","map","color","drag","resize","handleStyle","left","backgroundColor","width","right","params","minPxPerSec","play","pause","drawer","wrapper","clientWidth","segmentDuration","i","centerTime","t1","seekAndCenter","length","id","test","subscribe","unsubscribe","style","children","onMount","waveColor","progressColor","cursorColor","regionProps","fileName","_jsxFileName","lineNumber","columnNumber","height","onClick","e","blur","fontSize","title","marginLeft","control","checked","onChange","target","label","_c","$RefreshReg$"],"sources":["/home/gleb/my_app_test/src/audio/wavesurfer/WavePlayer.tsx"],"sourcesContent":["import { FC, useMemo, useRef, useState, useEffect, useCallback } from \"react\";\n\n// material ui\n// import { makeStyles, Theme } from \"@material-ui/core/styles\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport PlayCircleFilledIcon from \"@material-ui/icons/PlayCircleFilled\";\nimport PauseCircleFilledIcon from \"@material-ui/icons/PauseCircleFilled\";\nimport ZoomInIcon from \"@material-ui/icons/ZoomIn\";\nimport ZoomOutIcon from \"@material-ui/icons/ZoomOut\";\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\n\n// import FileService from \"services/FileService\";\n\n// import { Segment } from \"types/segment\";\n// import { File } from \"types/file\";\n\nimport { SegmentModel as Segment } from \"../AudioContext\";\n\nimport { WaveSurfer, WaveForm, Region } from \"wavesurfer-react\";\n\nimport { currTimeSubscriber, changeSegmentPositionSubscriber } from \"../../subscribers/PlayerSubscriber\";\n\n// const WaveSurfer2 = require('wavesurfer.js');\nconst RegionsPlugin = require(\"wavesurfer.js/dist/plugin/wavesurfer.regions.min\");\nconst TimelinePlugin = require(\"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\");\n\n// import { WaveSurfer as WaveSurferRef } from \"../utils/createWavesurfer\";\n// import RegionsPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.regions.min\";\n// import TimelinePlugin from \"wavesurfer.js/dist/plugin/wavesurfer.timeline.min\";\n// import CursorPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.cursor.min\";\n// import MyCustomPlugin from 'my-custom-plugin-path';\n\n// const useStyles = makeStyles((theme: Theme) => ({\n//   root: {\n//     // display: \"flex\",\n//     // alignItems: \"center\",\n//     // justifyContent: \"flex-End\",\n//   },\n//   container: {\n//     // display: \"flex\",\n//     // alignItems: \"center\",\n//     // cursor: \"pointer\",\n//   },\n// }));\n\ninterface Props {\n  file: File | null;\n  segments: Segment[];\n  activeSegmentProp: Segment | null;\n  url: string;\n}\n\nconst WavePlayer: FC<Props> = ({ file, segments, activeSegmentProp, url }) => {\n  // const dispatch = useDispatch();\n  // const classes = useStyles();\n  const [isPlay, setIsPlay] = useState<boolean>(false);\n  const [autoCenter, setAutoCenter] = useState<boolean>(true);\n  // const [isLoading, setIsLoading] = useState<boolean>(true);\n\n  const [zoom, setZoom] = useState<number>(10);\n  const [regions, setRegions] = useState<any>([]);\n  const [activeSegment, setActiveSegment] = useState<Segment | null>(activeSegmentProp);\n\n//   let url = FileService.getAudioUrl(!file ? \"\" : file.id);\n//   if (!file) {\n//     url = \"\";\n//   }\n\n  const plugins = useMemo(() => {\n    return [\n      {\n        plugin: RegionsPlugin,\n        options: { dragSelection: false, showTooltip: false,  },\n        key: '2837123',\n      },\n      {\n        plugin: TimelinePlugin,\n        options: {\n          container: \"#timeline\",\n          \n        },\n        key: '86829632163',\n      },\n    ].filter(Boolean);\n  }, []);\n\n  const wavesurferRef = useRef<any>(null);\n  const handleWSMount = useCallback((waveSurfer) => {\n    wavesurferRef.current = waveSurfer;\n    // wavesurferRef.current.normalize=true;\n    wavesurferRef.current.on(\"ready\", () => {\n      console.log(\"wavesurferRef event: ready\");\n      // setIsLoading(false);\n    });\n\n    wavesurferRef.current.on(\"region-update-End\", (s: any, event: any) => {\n      changeSegmentPositionSubscriber.next({ segment: s.data, Start: s.Start, End: s.End });\n    });\n\n    let lastTime = 0;\n    wavesurferRef.current.on(\"audioprocess\", (currentTime: number) => {\n      const diff = Math.abs(currentTime - lastTime);\n      if (diff > 0.1) {\n        lastTime = currentTime;\n        currTimeSubscriber.next(currentTime);\n      }\n    });\n  }, []);\n\n  function setZoomClick(zoom: number) {\n    if (zoom < 5) {\n      zoom = 5;\n    }\n    if (zoom > 200) {\n      zoom = 200;\n    }\n\n    // console.log(`setZoomClick: ${zoom}`)\n\n    setZoom(zoom);\n  }\n\n  function downloadAudio() {\n    fetch(url).then((res) => {\n      if (!file) {\n        return;\n      }\n      res.blob().then((blob) => {\n        let name = file.name;\n        if (!name.endsWith(\".wav\")) {\n          name += \".wav\";\n        }\n\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement(\"a\");\n        a.href = url;\n        a.download = name;\n        a.click();\n        a.remove();\n      });\n    });\n  }\n\n  // обработчик нажатия клавиш\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (!wavesurferRef.current) {\n        return;\n      }\n\n      const { key, ctrlKey } = event;\n      let isNeedExKey = document.activeElement?.tagName === \"TEXTAREA\";\n      isNeedExKey = isNeedExKey || document.activeElement?.tagName === \"INPUT\";\n      let isEx = true;\n      if (isNeedExKey) {\n        isEx = ctrlKey;\n      }\n\n      if (key === \" \" && isEx) {\n        setIsPlay((prev) => !prev);\n      }\n\n      if ((key === \"w\" || key === \"s\") && isEx) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n\n      if ((key === \"a\" || key === \"d\" || key === \"ф\" || key === \"в\") && isEx) {\n        let diff = 5;\n        if (activeSegment !== null) diff = 1;\n        if (key === \"a\" || key === \"ф\") diff *= -1;\n\n        const total = wavesurferRef.current.getDuration();\n        let need = wavesurferRef.current.getCurrentTime() + diff;\n        if (need < 0) need = 0;\n        if (need > total) need = total;\n        if (activeSegment && need < activeSegment.Start - 1) need = activeSegment.Start - 1;\n\n        wavesurferRef.current.setCurrentTime(need);\n        setIsPlay(true);\n\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    },\n    [activeSegment]\n  );\n\n  useEffect(() => {\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => {\n      window.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [handleKeyDown]);\n\n  useEffect(() => {\n    let regions2 = segments.map((s) => {\n      return {\n        // id: s.id,\n        Start: s.Start,\n        End: s.End,\n        color: \"#6ab4ff29\",\n        drag: false,\n        resize: true,\n        handleStyle: {\n          left: { backgroundColor: \"transparent\", width: \"5px\" },\n          right: { backgroundColor: \"transparent\", width: \"5px\" },\n        },\n        data: s,\n      };\n    });\n    setRegions(regions2);\n  }, [segments]);\n\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n\n    setZoom(10);\n\n    if (url === \"\") {\n      return;\n    }\n\n    // if (!file) {\n    //   return;\n    // }\n\n    // FileService.filePeakById(file.id).then(({ data }) => {\n    //   wavesurferRef.current.load(url, data.data, false, file.duration);\n    //   wavesurferRef.current.setCurrentTime(0);\n    //   // setIsPlay(true);\n    // });\n\n    // wavesurferRef.current.setCurrentTime(3);\n  }, [file, url]);\n\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n\n    if (wavesurferRef.current.params.minPxPerSec !== zoom) {\n      wavesurferRef.current.zoom(zoom);\n    }\n  }, [zoom]);\n\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n\n    if (isPlay) {\n      wavesurferRef.current.play();\n    } else {\n      wavesurferRef.current.pause();\n    }\n  }, [isPlay]);\n\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n\n    wavesurferRef.current.setAutoCenter(autoCenter);\n  }, [autoCenter]);\n\n  useEffect(() => {\n    if (!wavesurferRef.current) {\n      return;\n    }\n\n    setActiveSegment(activeSegmentProp);\n    // console.log(activeSegmentProp);\n    // console.log(`setActiveSegment: ${activeSegmentProp?.Start}`);\n\n    if (activeSegmentProp) {\n      // console.log(`clientWidth : ${wavesurferRef.current.drawer.wrapper.clientWidth}`);\n      // console.log(`width : ${wavesurferRef.current.drawer.width}`);\n      let zoom = 200;\n      const width = wavesurferRef.current.drawer.wrapper.clientWidth;\n      const segmentDuration = activeSegmentProp.End - activeSegmentProp.Start;\n\n      for (let i = 0; i < 10; i++) {\n        if (segmentDuration * zoom < width) {\n          break;\n        }\n        zoom /= 2;\n      }\n      if (zoom < 5) {\n        zoom = 5;\n      }\n\n      setZoomClick(zoom);\n      setAutoCenter(false);\n      setIsPlay(true);\n      const total = wavesurferRef.current.getDuration();\n      // console.log(`total: ${total}`)\n      if (total > 0) {\n        const centerTime = activeSegmentProp.Start + (activeSegmentProp.End - activeSegmentProp.Start) / 2;\n        const t1 = centerTime / total;\n\n        // console.log(`centerTime: ${centerTime}. t1: ${t1}. zoom: ${zoom}`);\n        wavesurferRef.current.zoom(zoom);\n        wavesurferRef.current.seekAndCenter(t1);\n        wavesurferRef.current.setCurrentTime(activeSegmentProp.Start);\n        wavesurferRef.current.play();\n      }\n    }\n\n    for (let i = 0; i < regions.length; i++) {\n      if (regions[i].color !== \"#6ab4ff29\") {\n        regions[i] = {\n          ...regions[i],\n          color: \"#6ab4ff29\",\n        };\n      }\n\n      if (activeSegmentProp?.id === regions[i].id) {\n        regions[i] = {\n          ...regions[i],\n          color: \"#2692ff40\",\n        };\n      }\n    }\n\n    // setRegions([...regions]);\n\n    const test = currTimeSubscriber.subscribe((currentTime) => {\n      if (wavesurferRef && activeSegmentProp && currentTime >= activeSegmentProp.End) {\n        wavesurferRef.current.setCurrentTime(activeSegmentProp.Start);\n      }\n    });\n    return () => {\n      test.unsubscribe();\n    };\n  }, [activeSegmentProp, regions]);\n\n  console.log(`AudioPlayer2 rEnder`);\n  return (\n    <div style={{ width: \"100%\" }}>\n      {/* {isLoading && ( */}\n      {/* <div style={{ position: \"absolute\", textAlign: \"center\", width: \"100%\", height: \"128px\", justifyContent: \"center\", alignItems: \"center\", }}>\n        Загрузка аудио, подождите...\n      </div> */}\n      {/* )} */}\n\n      <WaveSurfer\n        onMount={handleWSMount}\n        // src=\"https://freesound.org/data/previews/462/462807_8386274-lq.mp3\"\n        container='hfsjdf'\n        plugins={plugins}\n      >\n        {/* cursorColor=\"transparent\" */}\n        <WaveForm id=\"waveform\" waveColor=\"#b1d0f1\" progressColor=\"#b1d0f1\" cursorColor=\"red\" autoCenter={autoCenter}>\n          {regions.map((regionProps: any) => (\n            <Region key={regionProps.id} {...regionProps} />\n          ))}\n        </WaveForm>\n        <div style={{ height: \"20px\" }} id=\"timeline\" />\n      </WaveSurfer>\n\n      <div style={{ height: \"40px\" }}>\n        <IconButton\n          color=\"primary\"\n          onClick={(e: any) => {\n            (document.activeElement as HTMLElement).blur();\n            setIsPlay((prev) => !prev);\n          }}\n        >\n          {isPlay ? <PauseCircleFilledIcon fontSize=\"medium\" /> : <PlayCircleFilledIcon fontSize=\"medium\" />}\n        </IconButton>\n        <IconButton\n          color=\"primary\"\n          title=\"Увеличить масштаб\"\n          onClick={(e: any) => {\n            (document.activeElement as HTMLElement).blur();\n            setZoomClick(zoom * 2);\n          }}\n        >\n          <ZoomInIcon fontSize=\"medium\" />\n        </IconButton>\n        <IconButton\n          color=\"primary\"\n          title=\"Уменьшить масштаб\"\n          onClick={(e: any) => {\n            (document.activeElement as HTMLElement).blur();\n            setZoomClick(zoom / 2);\n          }}\n        >\n          <ZoomOutIcon fontSize=\"medium\" />\n        </IconButton>\n        <IconButton\n          color=\"primary\"\n          title=\"Скачать аудио\"\n          onClick={(e: any) => {\n            (document.activeElement as HTMLElement).blur();\n            downloadAudio();\n          }}\n        >\n          <GetAppIcon fontSize=\"medium\" />\n        </IconButton>\n\n        <FormControlLabel\n          style={{ marginLeft: \"10px\" }}\n          onClick={(e: any) => {\n            (document.activeElement as HTMLElement).blur();\n          }}\n          control={\n            <Checkbox\n              checked={autoCenter}\n              color=\"primary\"\n              onChange={(event: any) => {\n                setAutoCenter(event.target.checked);\n              }}\n            />\n          }\n          label=\"Позиция по центру\"\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default WavePlayer;\n"],"mappings":";;AAAA,SAAaA,OAAO,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;;AAE7E;AACA;AACA,OAAOC,UAAU,MAAM,8BAA8B;AACrD,OAAOC,oBAAoB,MAAM,qCAAqC;AACtE,OAAOC,qBAAqB,MAAM,sCAAsC;AACxE,OAAOC,UAAU,MAAM,2BAA2B;AAClD,OAAOC,WAAW,MAAM,4BAA4B;AACpD,OAAOC,UAAU,MAAM,2BAA2B;AAClD,OAAOC,QAAQ,MAAM,4BAA4B;AACjD,OAAOC,gBAAgB,MAAM,oCAAoC;;AAEjE;;AAEA;AACA;;AAIA,SAASC,UAAU,EAAEC,QAAQ,EAAEC,MAAM,QAAQ,kBAAkB;AAE/D,SAASC,kBAAkB,EAAEC,+BAA+B,QAAQ,oCAAoC;;AAExG;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,MAAMC,aAAa,GAAGC,OAAO,CAAC,kDAAkD,CAAC;AACjF,MAAMC,cAAc,GAAGD,OAAO,CAAC,mDAAmD,CAAC;;AAEnF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASA,MAAME,UAAqB,GAAGA,CAAC;EAAEC,IAAI;EAAEC,QAAQ;EAAEC,iBAAiB;EAAEC;AAAI,CAAC,KAAK;EAAAC,EAAA;EAC5E;EACA;EACA,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAG5B,QAAQ,CAAU,KAAK,CAAC;EACpD,MAAM,CAAC6B,UAAU,EAAEC,aAAa,CAAC,GAAG9B,QAAQ,CAAU,IAAI,CAAC;EAC3D;;EAEA,MAAM,CAAC+B,IAAI,EAAEC,OAAO,CAAC,GAAGhC,QAAQ,CAAS,EAAE,CAAC;EAC5C,MAAM,CAACiC,OAAO,EAAEC,UAAU,CAAC,GAAGlC,QAAQ,CAAM,EAAE,CAAC;EAC/C,MAAM,CAACmC,aAAa,EAAEC,gBAAgB,CAAC,GAAGpC,QAAQ,CAAiBwB,iBAAiB,CAAC;;EAEvF;EACA;EACA;EACA;;EAEE,MAAMa,OAAO,GAAGvC,OAAO,CAAC,MAAM;IAC5B,OAAO,CACL;MACEwC,MAAM,EAAEpB,aAAa;MACrBqB,OAAO,EAAE;QAAEC,aAAa,EAAE,KAAK;QAAEC,WAAW,EAAE;MAAQ,CAAC;MACvDC,GAAG,EAAE;IACP,CAAC,EACD;MACEJ,MAAM,EAAElB,cAAc;MACtBmB,OAAO,EAAE;QACPI,SAAS,EAAE;MAEb,CAAC;MACDD,GAAG,EAAE;IACP,CAAC,CACF,CAACE,MAAM,CAACC,OAAO,CAAC;EACnB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,aAAa,GAAG/C,MAAM,CAAM,IAAI,CAAC;EACvC,MAAMgD,aAAa,GAAG7C,WAAW,CAAE8C,UAAU,IAAK;IAChDF,aAAa,CAACG,OAAO,GAAGD,UAAU;IAClC;IACAF,aAAa,CAACG,OAAO,CAACC,EAAE,CAAC,OAAO,EAAE,MAAM;MACtCC,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;MACzC;IACF,CAAC,CAAC;IAEFN,aAAa,CAACG,OAAO,CAACC,EAAE,CAAC,mBAAmB,EAAE,CAACG,CAAM,EAAEC,KAAU,KAAK;MACpEvC,+BAA+B,CAACwC,IAAI,CAAC;QAAEC,OAAO,EAAEH,CAAC,CAACI,IAAI;QAAEC,KAAK,EAAEL,CAAC,CAACK,KAAK;QAAEC,GAAG,EAAEN,CAAC,CAACM;MAAI,CAAC,CAAC;IACvF,CAAC,CAAC;IAEF,IAAIC,QAAQ,GAAG,CAAC;IAChBd,aAAa,CAACG,OAAO,CAACC,EAAE,CAAC,cAAc,EAAGW,WAAmB,IAAK;MAChE,MAAMC,IAAI,GAAGC,IAAI,CAACC,GAAG,CAACH,WAAW,GAAGD,QAAQ,CAAC;MAC7C,IAAIE,IAAI,GAAG,GAAG,EAAE;QACdF,QAAQ,GAAGC,WAAW;QACtB/C,kBAAkB,CAACyC,IAAI,CAACM,WAAW,CAAC;MACtC;IACF,CAAC,CAAC;EACJ,CAAC,EAAE,EAAE,CAAC;EAEN,SAASI,YAAYA,CAAClC,IAAY,EAAE;IAClC,IAAIA,IAAI,GAAG,CAAC,EAAE;MACZA,IAAI,GAAG,CAAC;IACV;IACA,IAAIA,IAAI,GAAG,GAAG,EAAE;MACdA,IAAI,GAAG,GAAG;IACZ;;IAEA;;IAEAC,OAAO,CAACD,IAAI,CAAC;EACf;EAEA,SAASmC,aAAaA,CAAA,EAAG;IACvBC,KAAK,CAAC1C,GAAG,CAAC,CAAC2C,IAAI,CAAEC,GAAG,IAAK;MACvB,IAAI,CAAC/C,IAAI,EAAE;QACT;MACF;MACA+C,GAAG,CAACC,IAAI,CAAC,CAAC,CAACF,IAAI,CAAEE,IAAI,IAAK;QACxB,IAAIC,IAAI,GAAGjD,IAAI,CAACiD,IAAI;QACpB,IAAI,CAACA,IAAI,CAACC,QAAQ,CAAC,MAAM,CAAC,EAAE;UAC1BD,IAAI,IAAI,MAAM;QAChB;QAEA,MAAM9C,GAAG,GAAGgD,MAAM,CAACC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC;QAC5C,MAAMM,CAAC,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;QACrCF,CAAC,CAACG,IAAI,GAAGtD,GAAG;QACZmD,CAAC,CAACI,QAAQ,GAAGT,IAAI;QACjBK,CAAC,CAACK,KAAK,CAAC,CAAC;QACTL,CAAC,CAACM,MAAM,CAAC,CAAC;MACZ,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;;EAEA;EACA,MAAMC,aAAa,GAAGjF,WAAW,CAC9BoD,KAAK,IAAK;IAAA,IAAA8B,qBAAA,EAAAC,sBAAA;IACT,IAAI,CAACvC,aAAa,CAACG,OAAO,EAAE;MAC1B;IACF;IAEA,MAAM;MAAEP,GAAG;MAAE4C;IAAQ,CAAC,GAAGhC,KAAK;IAC9B,IAAIiC,WAAW,GAAG,EAAAH,qBAAA,GAAAP,QAAQ,CAACW,aAAa,cAAAJ,qBAAA,uBAAtBA,qBAAA,CAAwBK,OAAO,MAAK,UAAU;IAChEF,WAAW,GAAGA,WAAW,IAAI,EAAAF,sBAAA,GAAAR,QAAQ,CAACW,aAAa,cAAAH,sBAAA,uBAAtBA,sBAAA,CAAwBI,OAAO,MAAK,OAAO;IACxE,IAAIC,IAAI,GAAG,IAAI;IACf,IAAIH,WAAW,EAAE;MACfG,IAAI,GAAGJ,OAAO;IAChB;IAEA,IAAI5C,GAAG,KAAK,GAAG,IAAIgD,IAAI,EAAE;MACvB9D,SAAS,CAAE+D,IAAI,IAAK,CAACA,IAAI,CAAC;IAC5B;IAEA,IAAI,CAACjD,GAAG,KAAK,GAAG,IAAIA,GAAG,KAAK,GAAG,KAAKgD,IAAI,EAAE;MACxCpC,KAAK,CAACsC,cAAc,CAAC,CAAC;MACtBtC,KAAK,CAACuC,eAAe,CAAC,CAAC;IACzB;IAEA,IAAI,CAACnD,GAAG,KAAK,GAAG,IAAIA,GAAG,KAAK,GAAG,IAAIA,GAAG,KAAK,GAAG,IAAIA,GAAG,KAAK,GAAG,KAAKgD,IAAI,EAAE;MACtE,IAAI5B,IAAI,GAAG,CAAC;MACZ,IAAI3B,aAAa,KAAK,IAAI,EAAE2B,IAAI,GAAG,CAAC;MACpC,IAAIpB,GAAG,KAAK,GAAG,IAAIA,GAAG,KAAK,GAAG,EAAEoB,IAAI,IAAI,CAAC,CAAC;MAE1C,MAAMgC,KAAK,GAAGhD,aAAa,CAACG,OAAO,CAAC8C,WAAW,CAAC,CAAC;MACjD,IAAIC,IAAI,GAAGlD,aAAa,CAACG,OAAO,CAACgD,cAAc,CAAC,CAAC,GAAGnC,IAAI;MACxD,IAAIkC,IAAI,GAAG,CAAC,EAAEA,IAAI,GAAG,CAAC;MACtB,IAAIA,IAAI,GAAGF,KAAK,EAAEE,IAAI,GAAGF,KAAK;MAC9B,IAAI3D,aAAa,IAAI6D,IAAI,GAAG7D,aAAa,CAACuB,KAAK,GAAG,CAAC,EAAEsC,IAAI,GAAG7D,aAAa,CAACuB,KAAK,GAAG,CAAC;MAEnFZ,aAAa,CAACG,OAAO,CAACiD,cAAc,CAACF,IAAI,CAAC;MAC1CpE,SAAS,CAAC,IAAI,CAAC;MAEf0B,KAAK,CAACsC,cAAc,CAAC,CAAC;MACtBtC,KAAK,CAACuC,eAAe,CAAC,CAAC;IACzB;EACF,CAAC,EACD,CAAC1D,aAAa,CAChB,CAAC;EAEDlC,SAAS,CAAC,MAAM;IACdwE,MAAM,CAAC0B,gBAAgB,CAAC,SAAS,EAAEhB,aAAa,CAAC;IACjD,OAAO,MAAM;MACXV,MAAM,CAAC2B,mBAAmB,CAAC,SAAS,EAAEjB,aAAa,CAAC;IACtD,CAAC;EACH,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;EAEnBlF,SAAS,CAAC,MAAM;IACd,IAAIoG,QAAQ,GAAG9E,QAAQ,CAAC+E,GAAG,CAAEjD,CAAC,IAAK;MACjC,OAAO;QACL;QACAK,KAAK,EAAEL,CAAC,CAACK,KAAK;QACdC,GAAG,EAAEN,CAAC,CAACM,GAAG;QACV4C,KAAK,EAAE,WAAW;QAClBC,IAAI,EAAE,KAAK;QACXC,MAAM,EAAE,IAAI;QACZC,WAAW,EAAE;UACXC,IAAI,EAAE;YAAEC,eAAe,EAAE,aAAa;YAAEC,KAAK,EAAE;UAAM,CAAC;UACtDC,KAAK,EAAE;YAAEF,eAAe,EAAE,aAAa;YAAEC,KAAK,EAAE;UAAM;QACxD,CAAC;QACDpD,IAAI,EAAEJ;MACR,CAAC;IACH,CAAC,CAAC;IACFnB,UAAU,CAACmE,QAAQ,CAAC;EACtB,CAAC,EAAE,CAAC9E,QAAQ,CAAC,CAAC;EAEdtB,SAAS,CAAC,MAAM;IACd,IAAI,CAAC6C,aAAa,CAACG,OAAO,EAAE;MAC1B;IACF;IAEAjB,OAAO,CAAC,EAAE,CAAC;IAEX,IAAIP,GAAG,KAAK,EAAE,EAAE;MACd;IACF;;IAEA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;;IAEA;EACF,CAAC,EAAE,CAACH,IAAI,EAAEG,GAAG,CAAC,CAAC;EAEfxB,SAAS,CAAC,MAAM;IACd,IAAI,CAAC6C,aAAa,CAACG,OAAO,EAAE;MAC1B;IACF;IAEA,IAAIH,aAAa,CAACG,OAAO,CAAC8D,MAAM,CAACC,WAAW,KAAKjF,IAAI,EAAE;MACrDe,aAAa,CAACG,OAAO,CAAClB,IAAI,CAACA,IAAI,CAAC;IAClC;EACF,CAAC,EAAE,CAACA,IAAI,CAAC,CAAC;EAEV9B,SAAS,CAAC,MAAM;IACd,IAAI,CAAC6C,aAAa,CAACG,OAAO,EAAE;MAC1B;IACF;IAEA,IAAItB,MAAM,EAAE;MACVmB,aAAa,CAACG,OAAO,CAACgE,IAAI,CAAC,CAAC;IAC9B,CAAC,MAAM;MACLnE,aAAa,CAACG,OAAO,CAACiE,KAAK,CAAC,CAAC;IAC/B;EACF,CAAC,EAAE,CAACvF,MAAM,CAAC,CAAC;EAEZ1B,SAAS,CAAC,MAAM;IACd,IAAI,CAAC6C,aAAa,CAACG,OAAO,EAAE;MAC1B;IACF;IAEAH,aAAa,CAACG,OAAO,CAACnB,aAAa,CAACD,UAAU,CAAC;EACjD,CAAC,EAAE,CAACA,UAAU,CAAC,CAAC;EAEhB5B,SAAS,CAAC,MAAM;IACd,IAAI,CAAC6C,aAAa,CAACG,OAAO,EAAE;MAC1B;IACF;IAEAb,gBAAgB,CAACZ,iBAAiB,CAAC;IACnC;IACA;;IAEA,IAAIA,iBAAiB,EAAE;MACrB;MACA;MACA,IAAIO,IAAI,GAAG,GAAG;MACd,MAAM8E,KAAK,GAAG/D,aAAa,CAACG,OAAO,CAACkE,MAAM,CAACC,OAAO,CAACC,WAAW;MAC9D,MAAMC,eAAe,GAAG9F,iBAAiB,CAACmC,GAAG,GAAGnC,iBAAiB,CAACkC,KAAK;MAEvE,KAAK,IAAI6D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,EAAE,EAAE;QAC3B,IAAID,eAAe,GAAGvF,IAAI,GAAG8E,KAAK,EAAE;UAClC;QACF;QACA9E,IAAI,IAAI,CAAC;MACX;MACA,IAAIA,IAAI,GAAG,CAAC,EAAE;QACZA,IAAI,GAAG,CAAC;MACV;MAEAkC,YAAY,CAAClC,IAAI,CAAC;MAClBD,aAAa,CAAC,KAAK,CAAC;MACpBF,SAAS,CAAC,IAAI,CAAC;MACf,MAAMkE,KAAK,GAAGhD,aAAa,CAACG,OAAO,CAAC8C,WAAW,CAAC,CAAC;MACjD;MACA,IAAID,KAAK,GAAG,CAAC,EAAE;QACb,MAAM0B,UAAU,GAAGhG,iBAAiB,CAACkC,KAAK,GAAG,CAAClC,iBAAiB,CAACmC,GAAG,GAAGnC,iBAAiB,CAACkC,KAAK,IAAI,CAAC;QAClG,MAAM+D,EAAE,GAAGD,UAAU,GAAG1B,KAAK;;QAE7B;QACAhD,aAAa,CAACG,OAAO,CAAClB,IAAI,CAACA,IAAI,CAAC;QAChCe,aAAa,CAACG,OAAO,CAACyE,aAAa,CAACD,EAAE,CAAC;QACvC3E,aAAa,CAACG,OAAO,CAACiD,cAAc,CAAC1E,iBAAiB,CAACkC,KAAK,CAAC;QAC7DZ,aAAa,CAACG,OAAO,CAACgE,IAAI,CAAC,CAAC;MAC9B;IACF;IAEA,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGtF,OAAO,CAAC0F,MAAM,EAAEJ,CAAC,EAAE,EAAE;MACvC,IAAItF,OAAO,CAACsF,CAAC,CAAC,CAAChB,KAAK,KAAK,WAAW,EAAE;QACpCtE,OAAO,CAACsF,CAAC,CAAC,GAAG;UACX,GAAGtF,OAAO,CAACsF,CAAC,CAAC;UACbhB,KAAK,EAAE;QACT,CAAC;MACH;MAEA,IAAI,CAAA/E,iBAAiB,aAAjBA,iBAAiB,uBAAjBA,iBAAiB,CAAEoG,EAAE,MAAK3F,OAAO,CAACsF,CAAC,CAAC,CAACK,EAAE,EAAE;QAC3C3F,OAAO,CAACsF,CAAC,CAAC,GAAG;UACX,GAAGtF,OAAO,CAACsF,CAAC,CAAC;UACbhB,KAAK,EAAE;QACT,CAAC;MACH;IACF;;IAEA;;IAEA,MAAMsB,IAAI,GAAG/G,kBAAkB,CAACgH,SAAS,CAAEjE,WAAW,IAAK;MACzD,IAAIf,aAAa,IAAItB,iBAAiB,IAAIqC,WAAW,IAAIrC,iBAAiB,CAACmC,GAAG,EAAE;QAC9Eb,aAAa,CAACG,OAAO,CAACiD,cAAc,CAAC1E,iBAAiB,CAACkC,KAAK,CAAC;MAC/D;IACF,CAAC,CAAC;IACF,OAAO,MAAM;MACXmE,IAAI,CAACE,WAAW,CAAC,CAAC;IACpB,CAAC;EACH,CAAC,EAAE,CAACvG,iBAAiB,EAAES,OAAO,CAAC,CAAC;EAEhCkB,OAAO,CAACC,GAAG,CAAE,qBAAoB,CAAC;EAClC,oBACEnC,OAAA;IAAK+G,KAAK,EAAE;MAAEnB,KAAK,EAAE;IAAO,CAAE;IAAAoB,QAAA,gBAO5BhH,OAAA,CAACN,UAAU;MACTuH,OAAO,EAAEnF;MACT;MAAA;MACAJ,SAAS,EAAC,QAAQ;MAClBN,OAAO,EAAEA,OAAQ;MAAA4F,QAAA,gBAGjBhH,OAAA,CAACL,QAAQ;QAACgH,EAAE,EAAC,UAAU;QAACO,SAAS,EAAC,SAAS;QAACC,aAAa,EAAC,SAAS;QAACC,WAAW,EAAC,KAAK;QAACxG,UAAU,EAAEA,UAAW;QAAAoG,QAAA,EAC1GhG,OAAO,CAACqE,GAAG,CAAEgC,WAAgB,iBAC5BrH,OAAA,CAACJ,MAAM;UAAA,GAA0ByH;QAAW,GAA/BA,WAAW,CAACV,EAAE;UAAAW,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAoB,CAChD;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACM,CAAC,eACXzH,OAAA;QAAK+G,KAAK,EAAE;UAAEW,MAAM,EAAE;QAAO,CAAE;QAACf,EAAE,EAAC;MAAU;QAAAW,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtC,CAAC,eAEbzH,OAAA;MAAK+G,KAAK,EAAE;QAAEW,MAAM,EAAE;MAAO,CAAE;MAAAV,QAAA,gBAC7BhH,OAAA,CAACd,UAAU;QACToG,KAAK,EAAC,SAAS;QACfqC,OAAO,EAAGC,CAAM,IAAK;UAClBhE,QAAQ,CAACW,aAAa,CAAiBsD,IAAI,CAAC,CAAC;UAC9ClH,SAAS,CAAE+D,IAAI,IAAK,CAACA,IAAI,CAAC;QAC5B,CAAE;QAAAsC,QAAA,EAEDtG,MAAM,gBAAGV,OAAA,CAACZ,qBAAqB;UAAC0I,QAAQ,EAAC;QAAQ;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,gBAAGzH,OAAA,CAACb,oBAAoB;UAAC2I,QAAQ,EAAC;QAAQ;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACxF,CAAC,eACbzH,OAAA,CAACd,UAAU;QACToG,KAAK,EAAC,SAAS;QACfyC,KAAK,EAAC,mGAAmB;QACzBJ,OAAO,EAAGC,CAAM,IAAK;UAClBhE,QAAQ,CAACW,aAAa,CAAiBsD,IAAI,CAAC,CAAC;UAC9C7E,YAAY,CAAClC,IAAI,GAAG,CAAC,CAAC;QACxB,CAAE;QAAAkG,QAAA,eAEFhH,OAAA,CAACX,UAAU;UAACyI,QAAQ,EAAC;QAAQ;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC,eACbzH,OAAA,CAACd,UAAU;QACToG,KAAK,EAAC,SAAS;QACfyC,KAAK,EAAC,mGAAmB;QACzBJ,OAAO,EAAGC,CAAM,IAAK;UAClBhE,QAAQ,CAACW,aAAa,CAAiBsD,IAAI,CAAC,CAAC;UAC9C7E,YAAY,CAAClC,IAAI,GAAG,CAAC,CAAC;QACxB,CAAE;QAAAkG,QAAA,eAEFhH,OAAA,CAACV,WAAW;UAACwI,QAAQ,EAAC;QAAQ;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvB,CAAC,eACbzH,OAAA,CAACd,UAAU;QACToG,KAAK,EAAC,SAAS;QACfyC,KAAK,EAAC,2EAAe;QACrBJ,OAAO,EAAGC,CAAM,IAAK;UAClBhE,QAAQ,CAACW,aAAa,CAAiBsD,IAAI,CAAC,CAAC;UAC9C5E,aAAa,CAAC,CAAC;QACjB,CAAE;QAAA+D,QAAA,eAEFhH,OAAA,CAACT,UAAU;UAACuI,QAAQ,EAAC;QAAQ;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC,eAEbzH,OAAA,CAACP,gBAAgB;QACfsH,KAAK,EAAE;UAAEiB,UAAU,EAAE;QAAO,CAAE;QAC9BL,OAAO,EAAGC,CAAM,IAAK;UAClBhE,QAAQ,CAACW,aAAa,CAAiBsD,IAAI,CAAC,CAAC;QAChD,CAAE;QACFI,OAAO,eACLjI,OAAA,CAACR,QAAQ;UACP0I,OAAO,EAAEtH,UAAW;UACpB0E,KAAK,EAAC,SAAS;UACf6C,QAAQ,EAAG9F,KAAU,IAAK;YACxBxB,aAAa,CAACwB,KAAK,CAAC+F,MAAM,CAACF,OAAO,CAAC;UACrC;QAAE;UAAAZ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CACF;QACDY,KAAK,EAAC;MAAmB;QAAAf,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC1B,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;AAAChH,EAAA,CAnXIL,UAAqB;AAAAkI,EAAA,GAArBlI,UAAqB;AAqX3B,eAAeA,UAAU;AAAC,IAAAkI,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}